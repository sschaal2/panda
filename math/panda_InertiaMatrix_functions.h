
void
pandafunc11(void)
      {
/* rotation matrices */
S10[1][1]=cstate1th;
S10[1][2]=sstate1th;

S10[2][1]=-sstate1th;
S10[2][2]=cstate1th;


S21[1][1]=cstate2th;
S21[1][3]=-sstate2th;

S21[2][1]=-sstate2th;
S21[2][3]=-cstate2th;


S32[1][1]=cstate3th;
S32[1][3]=sstate3th;

S32[2][1]=-sstate3th;
S32[2][3]=cstate3th;


S43[1][1]=cstate4th;
S43[1][3]=sstate4th;

S43[2][1]=-sstate4th;
S43[2][3]=cstate4th;


S54[1][1]=cstate5th;
S54[1][3]=-sstate5th;

S54[2][1]=-sstate5th;
S54[2][3]=-cstate5th;


S65[1][1]=cstate6th;
S65[1][3]=sstate6th;

S65[2][1]=-sstate6th;
S65[2][3]=cstate6th;


S76[1][1]=cstate7th;
S76[1][3]=sstate7th;

S76[2][1]=-sstate7th;
S76[2][3]=cstate7th;


S87[1][1]=rceff1a2*rceff1a3;
S87[1][2]=rceff1a3*rseff1a1*rseff1a2 + rceff1a1*rseff1a3;
S87[1][3]=-(rceff1a1*rceff1a3*rseff1a2) + rseff1a1*rseff1a3;

S87[2][1]=-(rceff1a2*rseff1a3);
S87[2][2]=rceff1a1*rceff1a3 - rseff1a1*rseff1a2*rseff1a3;
S87[2][3]=rceff1a3*rseff1a1 + rceff1a1*rseff1a2*rseff1a3;

S87[3][1]=rseff1a2;
S87[3][2]=-(rceff1a2*rseff1a1);
S87[3][3]=rceff1a1*rceff1a2;




}


void
pandafunc12(void)
      {
/* inverse rotation matrices */
Si01[1][1]=cstate1th;
Si01[1][2]=-sstate1th;

Si01[2][1]=sstate1th;
Si01[2][2]=cstate1th;


Si12[1][1]=cstate2th;
Si12[1][2]=-sstate2th;

Si12[3][1]=-sstate2th;
Si12[3][2]=-cstate2th;


Si23[1][1]=cstate3th;
Si23[1][2]=-sstate3th;

Si23[3][1]=sstate3th;
Si23[3][2]=cstate3th;


Si34[1][1]=cstate4th;
Si34[1][2]=-sstate4th;

Si34[3][1]=sstate4th;
Si34[3][2]=cstate4th;


Si45[1][1]=cstate5th;
Si45[1][2]=-sstate5th;

Si45[3][1]=-sstate5th;
Si45[3][2]=-cstate5th;


Si56[1][1]=cstate6th;
Si56[1][2]=-sstate6th;

Si56[3][1]=sstate6th;
Si56[3][2]=cstate6th;


Si67[1][1]=cstate7th;
Si67[1][2]=-sstate7th;

Si67[3][1]=sstate7th;
Si67[3][2]=cstate7th;


Si78[1][1]=rceff1a2*rceff1a3;
Si78[1][2]=-(rceff1a2*rseff1a3);
Si78[1][3]=rseff1a2;

Si78[2][1]=rceff1a3*rseff1a1*rseff1a2 + rceff1a1*rseff1a3;
Si78[2][2]=rceff1a1*rceff1a3 - rseff1a1*rseff1a2*rseff1a3;
Si78[2][3]=-(rceff1a2*rseff1a1);

Si78[3][1]=-(rceff1a1*rceff1a3*rseff1a2) + rseff1a1*rseff1a3;
Si78[3][2]=rceff1a3*rseff1a1 + rceff1a1*rseff1a2*rseff1a3;
Si78[3][3]=rceff1a1*rceff1a2;




}


void
pandafunc13(void)
      {
/* composite inertia matrices */
Jc8[1][2]=eff[1].mcm[3];
Jc8[1][3]=-eff[1].mcm[2];
Jc8[1][4]=eff[1].m;

Jc8[2][1]=-eff[1].mcm[3];
Jc8[2][3]=eff[1].mcm[1];
Jc8[2][5]=eff[1].m;

Jc8[3][1]=eff[1].mcm[2];
Jc8[3][2]=-eff[1].mcm[1];
Jc8[3][6]=eff[1].m;

Jc8[4][5]=-eff[1].mcm[3];
Jc8[4][6]=eff[1].mcm[2];

Jc8[5][4]=eff[1].mcm[3];
Jc8[5][6]=-eff[1].mcm[1];

Jc8[6][4]=-eff[1].mcm[2];
Jc8[6][5]=eff[1].mcm[1];


Jc7[1][1]=Jc8[1][4]*(-(eff[1].x[3]*S87[1][2]) + eff[1].x[2]*S87[1][3])*Si78[1][1] + Jc8[2][5]*(-(eff[1].x[3]*S87[2][2]) + eff[1].x[2]*S87[2][3])*Si78[1][2] + S87[3][1]*(Jc8[1][3]*Si78[1][1] + Jc8[2][3]*Si78[1][2]) + Jc8[3][6]*(-(eff[1].x[3]*S87[3][2]) + eff[1].x[2]*S87[3][3])*Si78[1][3] + S87[1][1]*(Jc8[2][1]*Si78[1][2] + Jc8[3][1]*Si78[1][3]) + S87[2][1]*(Jc8[1][2]*Si78[1][1] + Jc8[3][2]*Si78[1][3]);
Jc7[1][2]=links[7].mcm[3] + Jc8[1][4]*(eff[1].x[3]*S87[1][1] - eff[1].x[1]*S87[1][3])*Si78[1][1] + Jc8[2][5]*(eff[1].x[3]*S87[2][1] - eff[1].x[1]*S87[2][3])*Si78[1][2] + S87[3][2]*(Jc8[1][3]*Si78[1][1] + Jc8[2][3]*Si78[1][2]) + Jc8[3][6]*(eff[1].x[3]*S87[3][1] - eff[1].x[1]*S87[3][3])*Si78[1][3] + S87[1][2]*(Jc8[2][1]*Si78[1][2] + Jc8[3][1]*Si78[1][3]) + S87[2][2]*(Jc8[1][2]*Si78[1][1] + Jc8[3][2]*Si78[1][3]);
Jc7[1][3]=-links[7].mcm[2] + Jc8[1][4]*(-(eff[1].x[2]*S87[1][1]) + eff[1].x[1]*S87[1][2])*Si78[1][1] + Jc8[2][5]*(-(eff[1].x[2]*S87[2][1]) + eff[1].x[1]*S87[2][2])*Si78[1][2] + S87[3][3]*(Jc8[1][3]*Si78[1][1] + Jc8[2][3]*Si78[1][2]) + Jc8[3][6]*(-(eff[1].x[2]*S87[3][1]) + eff[1].x[1]*S87[3][2])*Si78[1][3] + S87[1][3]*(Jc8[2][1]*Si78[1][2] + Jc8[3][1]*Si78[1][3]) + S87[2][3]*(Jc8[1][2]*Si78[1][1] + Jc8[3][2]*Si78[1][3]);
Jc7[1][4]=links[7].m + Jc8[1][4]*S87[1][1]*Si78[1][1] + Jc8[2][5]*S87[2][1]*Si78[1][2] + Jc8[3][6]*S87[3][1]*Si78[1][3];
Jc7[1][5]=Jc8[1][4]*S87[1][2]*Si78[1][1] + Jc8[2][5]*S87[2][2]*Si78[1][2] + Jc8[3][6]*S87[3][2]*Si78[1][3];
Jc7[1][6]=Jc8[1][4]*S87[1][3]*Si78[1][1] + Jc8[2][5]*S87[2][3]*Si78[1][2] + Jc8[3][6]*S87[3][3]*Si78[1][3];

Jc7[2][1]=-links[7].mcm[3] + Jc8[1][4]*(-(eff[1].x[3]*S87[1][2]) + eff[1].x[2]*S87[1][3])*Si78[2][1] + Jc8[2][5]*(-(eff[1].x[3]*S87[2][2]) + eff[1].x[2]*S87[2][3])*Si78[2][2] + S87[3][1]*(Jc8[1][3]*Si78[2][1] + Jc8[2][3]*Si78[2][2]) + Jc8[3][6]*(-(eff[1].x[3]*S87[3][2]) + eff[1].x[2]*S87[3][3])*Si78[2][3] + S87[1][1]*(Jc8[2][1]*Si78[2][2] + Jc8[3][1]*Si78[2][3]) + S87[2][1]*(Jc8[1][2]*Si78[2][1] + Jc8[3][2]*Si78[2][3]);
Jc7[2][2]=Jc8[1][4]*(eff[1].x[3]*S87[1][1] - eff[1].x[1]*S87[1][3])*Si78[2][1] + Jc8[2][5]*(eff[1].x[3]*S87[2][1] - eff[1].x[1]*S87[2][3])*Si78[2][2] + S87[3][2]*(Jc8[1][3]*Si78[2][1] + Jc8[2][3]*Si78[2][2]) + Jc8[3][6]*(eff[1].x[3]*S87[3][1] - eff[1].x[1]*S87[3][3])*Si78[2][3] + S87[1][2]*(Jc8[2][1]*Si78[2][2] + Jc8[3][1]*Si78[2][3]) + S87[2][2]*(Jc8[1][2]*Si78[2][1] + Jc8[3][2]*Si78[2][3]);
Jc7[2][3]=links[7].mcm[1] + Jc8[1][4]*(-(eff[1].x[2]*S87[1][1]) + eff[1].x[1]*S87[1][2])*Si78[2][1] + Jc8[2][5]*(-(eff[1].x[2]*S87[2][1]) + eff[1].x[1]*S87[2][2])*Si78[2][2] + S87[3][3]*(Jc8[1][3]*Si78[2][1] + Jc8[2][3]*Si78[2][2]) + Jc8[3][6]*(-(eff[1].x[2]*S87[3][1]) + eff[1].x[1]*S87[3][2])*Si78[2][3] + S87[1][3]*(Jc8[2][1]*Si78[2][2] + Jc8[3][1]*Si78[2][3]) + S87[2][3]*(Jc8[1][2]*Si78[2][1] + Jc8[3][2]*Si78[2][3]);
Jc7[2][4]=Jc8[1][4]*S87[1][1]*Si78[2][1] + Jc8[2][5]*S87[2][1]*Si78[2][2] + Jc8[3][6]*S87[3][1]*Si78[2][3];
Jc7[2][5]=links[7].m + Jc8[1][4]*S87[1][2]*Si78[2][1] + Jc8[2][5]*S87[2][2]*Si78[2][2] + Jc8[3][6]*S87[3][2]*Si78[2][3];
Jc7[2][6]=Jc8[1][4]*S87[1][3]*Si78[2][1] + Jc8[2][5]*S87[2][3]*Si78[2][2] + Jc8[3][6]*S87[3][3]*Si78[2][3];

Jc7[3][1]=links[7].mcm[2] + Jc8[1][4]*(-(eff[1].x[3]*S87[1][2]) + eff[1].x[2]*S87[1][3])*Si78[3][1] + Jc8[2][5]*(-(eff[1].x[3]*S87[2][2]) + eff[1].x[2]*S87[2][3])*Si78[3][2] + S87[3][1]*(Jc8[1][3]*Si78[3][1] + Jc8[2][3]*Si78[3][2]) + Jc8[3][6]*(-(eff[1].x[3]*S87[3][2]) + eff[1].x[2]*S87[3][3])*Si78[3][3] + S87[1][1]*(Jc8[2][1]*Si78[3][2] + Jc8[3][1]*Si78[3][3]) + S87[2][1]*(Jc8[1][2]*Si78[3][1] + Jc8[3][2]*Si78[3][3]);
Jc7[3][2]=-links[7].mcm[1] + Jc8[1][4]*(eff[1].x[3]*S87[1][1] - eff[1].x[1]*S87[1][3])*Si78[3][1] + Jc8[2][5]*(eff[1].x[3]*S87[2][1] - eff[1].x[1]*S87[2][3])*Si78[3][2] + S87[3][2]*(Jc8[1][3]*Si78[3][1] + Jc8[2][3]*Si78[3][2]) + Jc8[3][6]*(eff[1].x[3]*S87[3][1] - eff[1].x[1]*S87[3][3])*Si78[3][3] + S87[1][2]*(Jc8[2][1]*Si78[3][2] + Jc8[3][1]*Si78[3][3]) + S87[2][2]*(Jc8[1][2]*Si78[3][1] + Jc8[3][2]*Si78[3][3]);
Jc7[3][3]=Jc8[1][4]*(-(eff[1].x[2]*S87[1][1]) + eff[1].x[1]*S87[1][2])*Si78[3][1] + Jc8[2][5]*(-(eff[1].x[2]*S87[2][1]) + eff[1].x[1]*S87[2][2])*Si78[3][2] + S87[3][3]*(Jc8[1][3]*Si78[3][1] + Jc8[2][3]*Si78[3][2]) + Jc8[3][6]*(-(eff[1].x[2]*S87[3][1]) + eff[1].x[1]*S87[3][2])*Si78[3][3] + S87[1][3]*(Jc8[2][1]*Si78[3][2] + Jc8[3][1]*Si78[3][3]) + S87[2][3]*(Jc8[1][2]*Si78[3][1] + Jc8[3][2]*Si78[3][3]);
Jc7[3][4]=Jc8[1][4]*S87[1][1]*Si78[3][1] + Jc8[2][5]*S87[2][1]*Si78[3][2] + Jc8[3][6]*S87[3][1]*Si78[3][3];
Jc7[3][5]=Jc8[1][4]*S87[1][2]*Si78[3][1] + Jc8[2][5]*S87[2][2]*Si78[3][2] + Jc8[3][6]*S87[3][2]*Si78[3][3];
Jc7[3][6]=links[7].m + Jc8[1][4]*S87[1][3]*Si78[3][1] + Jc8[2][5]*S87[2][3]*Si78[3][2] + Jc8[3][6]*S87[3][3]*Si78[3][3];

Jc7[4][1]=links[7].inertia[1][1] + (-(eff[1].x[3]*S87[1][2]) + eff[1].x[2]*S87[1][3])*(Jc8[5][4]*Si78[1][2] + Jc8[6][4]*Si78[1][3] + Jc8[1][4]*(-(eff[1].x[3]*Si78[2][1]) + eff[1].x[2]*Si78[3][1])) + S87[3][1]*(Jc8[1][3]*(-(eff[1].x[3]*Si78[2][1]) + eff[1].x[2]*Si78[3][1]) + Jc8[2][3]*(-(eff[1].x[3]*Si78[2][2]) + eff[1].x[2]*Si78[3][2])) + (-(eff[1].x[3]*S87[2][2]) + eff[1].x[2]*S87[2][3])*(Jc8[4][5]*Si78[1][1] + Jc8[6][5]*Si78[1][3] + Jc8[2][5]*(-(eff[1].x[3]*Si78[2][2]) + eff[1].x[2]*Si78[3][2])) + S87[1][1]*(Jc8[2][1]*(-(eff[1].x[3]*Si78[2][2]) + eff[1].x[2]*Si78[3][2]) + Jc8[3][1]*(-(eff[1].x[3]*Si78[2][3]) + eff[1].x[2]*Si78[3][3])) + S87[2][1]*(Jc8[1][2]*(-(eff[1].x[3]*Si78[2][1]) + eff[1].x[2]*Si78[3][1]) + Jc8[3][2]*(-(eff[1].x[3]*Si78[2][3]) + eff[1].x[2]*Si78[3][3])) + (-(eff[1].x[3]*S87[3][2]) + eff[1].x[2]*S87[3][3])*(Jc8[4][6]*Si78[1][1] + Jc8[5][6]*Si78[1][2] + Jc8[3][6]*(-(eff[1].x[3]*Si78[2][3]) + eff[1].x[2]*Si78[3][3]));
Jc7[4][2]=links[7].inertia[1][2] + (eff[1].x[3]*S87[1][1] - eff[1].x[1]*S87[1][3])*(Jc8[5][4]*Si78[1][2] + Jc8[6][4]*Si78[1][3] + Jc8[1][4]*(-(eff[1].x[3]*Si78[2][1]) + eff[1].x[2]*Si78[3][1])) + S87[3][2]*(Jc8[1][3]*(-(eff[1].x[3]*Si78[2][1]) + eff[1].x[2]*Si78[3][1]) + Jc8[2][3]*(-(eff[1].x[3]*Si78[2][2]) + eff[1].x[2]*Si78[3][2])) + (eff[1].x[3]*S87[2][1] - eff[1].x[1]*S87[2][3])*(Jc8[4][5]*Si78[1][1] + Jc8[6][5]*Si78[1][3] + Jc8[2][5]*(-(eff[1].x[3]*Si78[2][2]) + eff[1].x[2]*Si78[3][2])) + S87[1][2]*(Jc8[2][1]*(-(eff[1].x[3]*Si78[2][2]) + eff[1].x[2]*Si78[3][2]) + Jc8[3][1]*(-(eff[1].x[3]*Si78[2][3]) + eff[1].x[2]*Si78[3][3])) + S87[2][2]*(Jc8[1][2]*(-(eff[1].x[3]*Si78[2][1]) + eff[1].x[2]*Si78[3][1]) + Jc8[3][2]*(-(eff[1].x[3]*Si78[2][3]) + eff[1].x[2]*Si78[3][3])) + (eff[1].x[3]*S87[3][1] - eff[1].x[1]*S87[3][3])*(Jc8[4][6]*Si78[1][1] + Jc8[5][6]*Si78[1][2] + Jc8[3][6]*(-(eff[1].x[3]*Si78[2][3]) + eff[1].x[2]*Si78[3][3]));
Jc7[4][3]=links[7].inertia[1][3] + (-(eff[1].x[2]*S87[1][1]) + eff[1].x[1]*S87[1][2])*(Jc8[5][4]*Si78[1][2] + Jc8[6][4]*Si78[1][3] + Jc8[1][4]*(-(eff[1].x[3]*Si78[2][1]) + eff[1].x[2]*Si78[3][1])) + S87[3][3]*(Jc8[1][3]*(-(eff[1].x[3]*Si78[2][1]) + eff[1].x[2]*Si78[3][1]) + Jc8[2][3]*(-(eff[1].x[3]*Si78[2][2]) + eff[1].x[2]*Si78[3][2])) + (-(eff[1].x[2]*S87[2][1]) + eff[1].x[1]*S87[2][2])*(Jc8[4][5]*Si78[1][1] + Jc8[6][5]*Si78[1][3] + Jc8[2][5]*(-(eff[1].x[3]*Si78[2][2]) + eff[1].x[2]*Si78[3][2])) + S87[1][3]*(Jc8[2][1]*(-(eff[1].x[3]*Si78[2][2]) + eff[1].x[2]*Si78[3][2]) + Jc8[3][1]*(-(eff[1].x[3]*Si78[2][3]) + eff[1].x[2]*Si78[3][3])) + S87[2][3]*(Jc8[1][2]*(-(eff[1].x[3]*Si78[2][1]) + eff[1].x[2]*Si78[3][1]) + Jc8[3][2]*(-(eff[1].x[3]*Si78[2][3]) + eff[1].x[2]*Si78[3][3])) + (-(eff[1].x[2]*S87[3][1]) + eff[1].x[1]*S87[3][2])*(Jc8[4][6]*Si78[1][1] + Jc8[5][6]*Si78[1][2] + Jc8[3][6]*(-(eff[1].x[3]*Si78[2][3]) + eff[1].x[2]*Si78[3][3]));
Jc7[4][4]=S87[1][1]*(Jc8[5][4]*Si78[1][2] + Jc8[6][4]*Si78[1][3] + Jc8[1][4]*(-(eff[1].x[3]*Si78[2][1]) + eff[1].x[2]*Si78[3][1])) + S87[2][1]*(Jc8[4][5]*Si78[1][1] + Jc8[6][5]*Si78[1][3] + Jc8[2][5]*(-(eff[1].x[3]*Si78[2][2]) + eff[1].x[2]*Si78[3][2])) + S87[3][1]*(Jc8[4][6]*Si78[1][1] + Jc8[5][6]*Si78[1][2] + Jc8[3][6]*(-(eff[1].x[3]*Si78[2][3]) + eff[1].x[2]*Si78[3][3]));
Jc7[4][5]=-links[7].mcm[3] + S87[1][2]*(Jc8[5][4]*Si78[1][2] + Jc8[6][4]*Si78[1][3] + Jc8[1][4]*(-(eff[1].x[3]*Si78[2][1]) + eff[1].x[2]*Si78[3][1])) + S87[2][2]*(Jc8[4][5]*Si78[1][1] + Jc8[6][5]*Si78[1][3] + Jc8[2][5]*(-(eff[1].x[3]*Si78[2][2]) + eff[1].x[2]*Si78[3][2])) + S87[3][2]*(Jc8[4][6]*Si78[1][1] + Jc8[5][6]*Si78[1][2] + Jc8[3][6]*(-(eff[1].x[3]*Si78[2][3]) + eff[1].x[2]*Si78[3][3]));
Jc7[4][6]=links[7].mcm[2] + S87[1][3]*(Jc8[5][4]*Si78[1][2] + Jc8[6][4]*Si78[1][3] + Jc8[1][4]*(-(eff[1].x[3]*Si78[2][1]) + eff[1].x[2]*Si78[3][1])) + S87[2][3]*(Jc8[4][5]*Si78[1][1] + Jc8[6][5]*Si78[1][3] + Jc8[2][5]*(-(eff[1].x[3]*Si78[2][2]) + eff[1].x[2]*Si78[3][2])) + S87[3][3]*(Jc8[4][6]*Si78[1][1] + Jc8[5][6]*Si78[1][2] + Jc8[3][6]*(-(eff[1].x[3]*Si78[2][3]) + eff[1].x[2]*Si78[3][3]));

Jc7[5][1]=links[7].inertia[1][2] + (-(eff[1].x[3]*S87[1][2]) + eff[1].x[2]*S87[1][3])*(Jc8[5][4]*Si78[2][2] + Jc8[6][4]*Si78[2][3] + Jc8[1][4]*(eff[1].x[3]*Si78[1][1] - eff[1].x[1]*Si78[3][1])) + S87[3][1]*(Jc8[1][3]*(eff[1].x[3]*Si78[1][1] - eff[1].x[1]*Si78[3][1]) + Jc8[2][3]*(eff[1].x[3]*Si78[1][2] - eff[1].x[1]*Si78[3][2])) + (-(eff[1].x[3]*S87[2][2]) + eff[1].x[2]*S87[2][3])*(Jc8[4][5]*Si78[2][1] + Jc8[6][5]*Si78[2][3] + Jc8[2][5]*(eff[1].x[3]*Si78[1][2] - eff[1].x[1]*Si78[3][2])) + S87[1][1]*(Jc8[2][1]*(eff[1].x[3]*Si78[1][2] - eff[1].x[1]*Si78[3][2]) + Jc8[3][1]*(eff[1].x[3]*Si78[1][3] - eff[1].x[1]*Si78[3][3])) + S87[2][1]*(Jc8[1][2]*(eff[1].x[3]*Si78[1][1] - eff[1].x[1]*Si78[3][1]) + Jc8[3][2]*(eff[1].x[3]*Si78[1][3] - eff[1].x[1]*Si78[3][3])) + (-(eff[1].x[3]*S87[3][2]) + eff[1].x[2]*S87[3][3])*(Jc8[4][6]*Si78[2][1] + Jc8[5][6]*Si78[2][2] + Jc8[3][6]*(eff[1].x[3]*Si78[1][3] - eff[1].x[1]*Si78[3][3]));
Jc7[5][2]=links[7].inertia[2][2] + (eff[1].x[3]*S87[1][1] - eff[1].x[1]*S87[1][3])*(Jc8[5][4]*Si78[2][2] + Jc8[6][4]*Si78[2][3] + Jc8[1][4]*(eff[1].x[3]*Si78[1][1] - eff[1].x[1]*Si78[3][1])) + S87[3][2]*(Jc8[1][3]*(eff[1].x[3]*Si78[1][1] - eff[1].x[1]*Si78[3][1]) + Jc8[2][3]*(eff[1].x[3]*Si78[1][2] - eff[1].x[1]*Si78[3][2])) + (eff[1].x[3]*S87[2][1] - eff[1].x[1]*S87[2][3])*(Jc8[4][5]*Si78[2][1] + Jc8[6][5]*Si78[2][3] + Jc8[2][5]*(eff[1].x[3]*Si78[1][2] - eff[1].x[1]*Si78[3][2])) + S87[1][2]*(Jc8[2][1]*(eff[1].x[3]*Si78[1][2] - eff[1].x[1]*Si78[3][2]) + Jc8[3][1]*(eff[1].x[3]*Si78[1][3] - eff[1].x[1]*Si78[3][3])) + S87[2][2]*(Jc8[1][2]*(eff[1].x[3]*Si78[1][1] - eff[1].x[1]*Si78[3][1]) + Jc8[3][2]*(eff[1].x[3]*Si78[1][3] - eff[1].x[1]*Si78[3][3])) + (eff[1].x[3]*S87[3][1] - eff[1].x[1]*S87[3][3])*(Jc8[4][6]*Si78[2][1] + Jc8[5][6]*Si78[2][2] + Jc8[3][6]*(eff[1].x[3]*Si78[1][3] - eff[1].x[1]*Si78[3][3]));
Jc7[5][3]=links[7].inertia[2][3] + (-(eff[1].x[2]*S87[1][1]) + eff[1].x[1]*S87[1][2])*(Jc8[5][4]*Si78[2][2] + Jc8[6][4]*Si78[2][3] + Jc8[1][4]*(eff[1].x[3]*Si78[1][1] - eff[1].x[1]*Si78[3][1])) + S87[3][3]*(Jc8[1][3]*(eff[1].x[3]*Si78[1][1] - eff[1].x[1]*Si78[3][1]) + Jc8[2][3]*(eff[1].x[3]*Si78[1][2] - eff[1].x[1]*Si78[3][2])) + (-(eff[1].x[2]*S87[2][1]) + eff[1].x[1]*S87[2][2])*(Jc8[4][5]*Si78[2][1] + Jc8[6][5]*Si78[2][3] + Jc8[2][5]*(eff[1].x[3]*Si78[1][2] - eff[1].x[1]*Si78[3][2])) + S87[1][3]*(Jc8[2][1]*(eff[1].x[3]*Si78[1][2] - eff[1].x[1]*Si78[3][2]) + Jc8[3][1]*(eff[1].x[3]*Si78[1][3] - eff[1].x[1]*Si78[3][3])) + S87[2][3]*(Jc8[1][2]*(eff[1].x[3]*Si78[1][1] - eff[1].x[1]*Si78[3][1]) + Jc8[3][2]*(eff[1].x[3]*Si78[1][3] - eff[1].x[1]*Si78[3][3])) + (-(eff[1].x[2]*S87[3][1]) + eff[1].x[1]*S87[3][2])*(Jc8[4][6]*Si78[2][1] + Jc8[5][6]*Si78[2][2] + Jc8[3][6]*(eff[1].x[3]*Si78[1][3] - eff[1].x[1]*Si78[3][3]));
Jc7[5][4]=links[7].mcm[3] + S87[1][1]*(Jc8[5][4]*Si78[2][2] + Jc8[6][4]*Si78[2][3] + Jc8[1][4]*(eff[1].x[3]*Si78[1][1] - eff[1].x[1]*Si78[3][1])) + S87[2][1]*(Jc8[4][5]*Si78[2][1] + Jc8[6][5]*Si78[2][3] + Jc8[2][5]*(eff[1].x[3]*Si78[1][2] - eff[1].x[1]*Si78[3][2])) + S87[3][1]*(Jc8[4][6]*Si78[2][1] + Jc8[5][6]*Si78[2][2] + Jc8[3][6]*(eff[1].x[3]*Si78[1][3] - eff[1].x[1]*Si78[3][3]));
Jc7[5][5]=S87[1][2]*(Jc8[5][4]*Si78[2][2] + Jc8[6][4]*Si78[2][3] + Jc8[1][4]*(eff[1].x[3]*Si78[1][1] - eff[1].x[1]*Si78[3][1])) + S87[2][2]*(Jc8[4][5]*Si78[2][1] + Jc8[6][5]*Si78[2][3] + Jc8[2][5]*(eff[1].x[3]*Si78[1][2] - eff[1].x[1]*Si78[3][2])) + S87[3][2]*(Jc8[4][6]*Si78[2][1] + Jc8[5][6]*Si78[2][2] + Jc8[3][6]*(eff[1].x[3]*Si78[1][3] - eff[1].x[1]*Si78[3][3]));
Jc7[5][6]=-links[7].mcm[1] + S87[1][3]*(Jc8[5][4]*Si78[2][2] + Jc8[6][4]*Si78[2][3] + Jc8[1][4]*(eff[1].x[3]*Si78[1][1] - eff[1].x[1]*Si78[3][1])) + S87[2][3]*(Jc8[4][5]*Si78[2][1] + Jc8[6][5]*Si78[2][3] + Jc8[2][5]*(eff[1].x[3]*Si78[1][2] - eff[1].x[1]*Si78[3][2])) + S87[3][3]*(Jc8[4][6]*Si78[2][1] + Jc8[5][6]*Si78[2][2] + Jc8[3][6]*(eff[1].x[3]*Si78[1][3] - eff[1].x[1]*Si78[3][3]));

Jc7[6][1]=links[7].inertia[1][3] + S87[3][1]*(Jc8[1][3]*(-(eff[1].x[2]*Si78[1][1]) + eff[1].x[1]*Si78[2][1]) + Jc8[2][3]*(-(eff[1].x[2]*Si78[1][2]) + eff[1].x[1]*Si78[2][2])) + S87[1][1]*(Jc8[2][1]*(-(eff[1].x[2]*Si78[1][2]) + eff[1].x[1]*Si78[2][2]) + Jc8[3][1]*(-(eff[1].x[2]*Si78[1][3]) + eff[1].x[1]*Si78[2][3])) + S87[2][1]*(Jc8[1][2]*(-(eff[1].x[2]*Si78[1][1]) + eff[1].x[1]*Si78[2][1]) + Jc8[3][2]*(-(eff[1].x[2]*Si78[1][3]) + eff[1].x[1]*Si78[2][3])) + (-(eff[1].x[3]*S87[3][2]) + eff[1].x[2]*S87[3][3])*(Jc8[3][6]*(-(eff[1].x[2]*Si78[1][3]) + eff[1].x[1]*Si78[2][3]) + Jc8[4][6]*Si78[3][1] + Jc8[5][6]*Si78[3][2]) + (-(eff[1].x[3]*S87[1][2]) + eff[1].x[2]*S87[1][3])*(Jc8[1][4]*(-(eff[1].x[2]*Si78[1][1]) + eff[1].x[1]*Si78[2][1]) + Jc8[5][4]*Si78[3][2] + Jc8[6][4]*Si78[3][3]) + (-(eff[1].x[3]*S87[2][2]) + eff[1].x[2]*S87[2][3])*(Jc8[2][5]*(-(eff[1].x[2]*Si78[1][2]) + eff[1].x[1]*Si78[2][2]) + Jc8[4][5]*Si78[3][1] + Jc8[6][5]*Si78[3][3]);
Jc7[6][2]=links[7].inertia[2][3] + S87[3][2]*(Jc8[1][3]*(-(eff[1].x[2]*Si78[1][1]) + eff[1].x[1]*Si78[2][1]) + Jc8[2][3]*(-(eff[1].x[2]*Si78[1][2]) + eff[1].x[1]*Si78[2][2])) + S87[1][2]*(Jc8[2][1]*(-(eff[1].x[2]*Si78[1][2]) + eff[1].x[1]*Si78[2][2]) + Jc8[3][1]*(-(eff[1].x[2]*Si78[1][3]) + eff[1].x[1]*Si78[2][3])) + S87[2][2]*(Jc8[1][2]*(-(eff[1].x[2]*Si78[1][1]) + eff[1].x[1]*Si78[2][1]) + Jc8[3][2]*(-(eff[1].x[2]*Si78[1][3]) + eff[1].x[1]*Si78[2][3])) + (eff[1].x[3]*S87[3][1] - eff[1].x[1]*S87[3][3])*(Jc8[3][6]*(-(eff[1].x[2]*Si78[1][3]) + eff[1].x[1]*Si78[2][3]) + Jc8[4][6]*Si78[3][1] + Jc8[5][6]*Si78[3][2]) + (eff[1].x[3]*S87[1][1] - eff[1].x[1]*S87[1][3])*(Jc8[1][4]*(-(eff[1].x[2]*Si78[1][1]) + eff[1].x[1]*Si78[2][1]) + Jc8[5][4]*Si78[3][2] + Jc8[6][4]*Si78[3][3]) + (eff[1].x[3]*S87[2][1] - eff[1].x[1]*S87[2][3])*(Jc8[2][5]*(-(eff[1].x[2]*Si78[1][2]) + eff[1].x[1]*Si78[2][2]) + Jc8[4][5]*Si78[3][1] + Jc8[6][5]*Si78[3][3]);
Jc7[6][3]=links[7].inertia[3][3] + S87[3][3]*(Jc8[1][3]*(-(eff[1].x[2]*Si78[1][1]) + eff[1].x[1]*Si78[2][1]) + Jc8[2][3]*(-(eff[1].x[2]*Si78[1][2]) + eff[1].x[1]*Si78[2][2])) + S87[1][3]*(Jc8[2][1]*(-(eff[1].x[2]*Si78[1][2]) + eff[1].x[1]*Si78[2][2]) + Jc8[3][1]*(-(eff[1].x[2]*Si78[1][3]) + eff[1].x[1]*Si78[2][3])) + S87[2][3]*(Jc8[1][2]*(-(eff[1].x[2]*Si78[1][1]) + eff[1].x[1]*Si78[2][1]) + Jc8[3][2]*(-(eff[1].x[2]*Si78[1][3]) + eff[1].x[1]*Si78[2][3])) + (-(eff[1].x[2]*S87[3][1]) + eff[1].x[1]*S87[3][2])*(Jc8[3][6]*(-(eff[1].x[2]*Si78[1][3]) + eff[1].x[1]*Si78[2][3]) + Jc8[4][6]*Si78[3][1] + Jc8[5][6]*Si78[3][2]) + (-(eff[1].x[2]*S87[1][1]) + eff[1].x[1]*S87[1][2])*(Jc8[1][4]*(-(eff[1].x[2]*Si78[1][1]) + eff[1].x[1]*Si78[2][1]) + Jc8[5][4]*Si78[3][2] + Jc8[6][4]*Si78[3][3]) + (-(eff[1].x[2]*S87[2][1]) + eff[1].x[1]*S87[2][2])*(Jc8[2][5]*(-(eff[1].x[2]*Si78[1][2]) + eff[1].x[1]*Si78[2][2]) + Jc8[4][5]*Si78[3][1] + Jc8[6][5]*Si78[3][3]);
Jc7[6][4]=-links[7].mcm[2] + S87[3][1]*(Jc8[3][6]*(-(eff[1].x[2]*Si78[1][3]) + eff[1].x[1]*Si78[2][3]) + Jc8[4][6]*Si78[3][1] + Jc8[5][6]*Si78[3][2]) + S87[1][1]*(Jc8[1][4]*(-(eff[1].x[2]*Si78[1][1]) + eff[1].x[1]*Si78[2][1]) + Jc8[5][4]*Si78[3][2] + Jc8[6][4]*Si78[3][3]) + S87[2][1]*(Jc8[2][5]*(-(eff[1].x[2]*Si78[1][2]) + eff[1].x[1]*Si78[2][2]) + Jc8[4][5]*Si78[3][1] + Jc8[6][5]*Si78[3][3]);
Jc7[6][5]=links[7].mcm[1] + S87[3][2]*(Jc8[3][6]*(-(eff[1].x[2]*Si78[1][3]) + eff[1].x[1]*Si78[2][3]) + Jc8[4][6]*Si78[3][1] + Jc8[5][6]*Si78[3][2]) + S87[1][2]*(Jc8[1][4]*(-(eff[1].x[2]*Si78[1][1]) + eff[1].x[1]*Si78[2][1]) + Jc8[5][4]*Si78[3][2] + Jc8[6][4]*Si78[3][3]) + S87[2][2]*(Jc8[2][5]*(-(eff[1].x[2]*Si78[1][2]) + eff[1].x[1]*Si78[2][2]) + Jc8[4][5]*Si78[3][1] + Jc8[6][5]*Si78[3][3]);
Jc7[6][6]=S87[3][3]*(Jc8[3][6]*(-(eff[1].x[2]*Si78[1][3]) + eff[1].x[1]*Si78[2][3]) + Jc8[4][6]*Si78[3][1] + Jc8[5][6]*Si78[3][2]) + S87[1][3]*(Jc8[1][4]*(-(eff[1].x[2]*Si78[1][1]) + eff[1].x[1]*Si78[2][1]) + Jc8[5][4]*Si78[3][2] + Jc8[6][4]*Si78[3][3]) + S87[2][3]*(Jc8[2][5]*(-(eff[1].x[2]*Si78[1][2]) + eff[1].x[1]*Si78[2][2]) + Jc8[4][5]*Si78[3][1] + Jc8[6][5]*Si78[3][3]);


Jc6[1][1]=S76[1][1]*(Jc7[1][1]*Si67[1][1] + Jc7[2][1]*Si67[1][2]) + S76[2][1]*(Jc7[1][2]*Si67[1][1] + Jc7[2][2]*Si67[1][2]);
Jc6[1][2]=links[6].mcm[3] - Jc7[1][3]*Si67[1][1] - Jc7[2][3]*Si67[1][2] - DHA7*S76[1][3]*(Jc7[1][4]*Si67[1][1] + Jc7[2][4]*Si67[1][2]) - DHA7*S76[2][3]*(Jc7[1][5]*Si67[1][1] + Jc7[2][5]*Si67[1][2]);
Jc6[1][3]=-links[6].mcm[2] + S76[1][3]*(Jc7[1][1]*Si67[1][1] + Jc7[2][1]*Si67[1][2]) + S76[2][3]*(Jc7[1][2]*Si67[1][1] + Jc7[2][2]*Si67[1][2]) - DHA7*(Jc7[1][6]*Si67[1][1] + Jc7[2][6]*Si67[1][2]);
Jc6[1][4]=links[6].m + S76[1][1]*(Jc7[1][4]*Si67[1][1] + Jc7[2][4]*Si67[1][2]) + S76[2][1]*(Jc7[1][5]*Si67[1][1] + Jc7[2][5]*Si67[1][2]);
Jc6[1][5]=-(Jc7[1][6]*Si67[1][1]) - Jc7[2][6]*Si67[1][2];
Jc6[1][6]=S76[1][3]*(Jc7[1][4]*Si67[1][1] + Jc7[2][4]*Si67[1][2]) + S76[2][3]*(Jc7[1][5]*Si67[1][1] + Jc7[2][5]*Si67[1][2]);

Jc6[2][1]=-links[6].mcm[3] - Jc7[3][1]*S76[1][1] - Jc7[3][2]*S76[2][1];
Jc6[2][2]=Jc7[3][3] + DHA7*Jc7[3][4]*S76[1][3] + DHA7*Jc7[3][5]*S76[2][3];
Jc6[2][3]=links[6].mcm[1] + DHA7*Jc7[3][6] - Jc7[3][1]*S76[1][3] - Jc7[3][2]*S76[2][3];
Jc6[2][4]=-(Jc7[3][4]*S76[1][1]) - Jc7[3][5]*S76[2][1];
Jc6[2][5]=links[6].m + Jc7[3][6];
Jc6[2][6]=-(Jc7[3][4]*S76[1][3]) - Jc7[3][5]*S76[2][3];

Jc6[3][1]=links[6].mcm[2] + S76[1][1]*(Jc7[1][1]*Si67[3][1] + Jc7[2][1]*Si67[3][2]) + S76[2][1]*(Jc7[1][2]*Si67[3][1] + Jc7[2][2]*Si67[3][2]);
Jc6[3][2]=-links[6].mcm[1] - Jc7[1][3]*Si67[3][1] - Jc7[2][3]*Si67[3][2] - DHA7*S76[1][3]*(Jc7[1][4]*Si67[3][1] + Jc7[2][4]*Si67[3][2]) - DHA7*S76[2][3]*(Jc7[1][5]*Si67[3][1] + Jc7[2][5]*Si67[3][2]);
Jc6[3][3]=S76[1][3]*(Jc7[1][1]*Si67[3][1] + Jc7[2][1]*Si67[3][2]) + S76[2][3]*(Jc7[1][2]*Si67[3][1] + Jc7[2][2]*Si67[3][2]) - DHA7*(Jc7[1][6]*Si67[3][1] + Jc7[2][6]*Si67[3][2]);
Jc6[3][4]=S76[1][1]*(Jc7[1][4]*Si67[3][1] + Jc7[2][4]*Si67[3][2]) + S76[2][1]*(Jc7[1][5]*Si67[3][1] + Jc7[2][5]*Si67[3][2]);
Jc6[3][5]=-(Jc7[1][6]*Si67[3][1]) - Jc7[2][6]*Si67[3][2];
Jc6[3][6]=links[6].m + S76[1][3]*(Jc7[1][4]*Si67[3][1] + Jc7[2][4]*Si67[3][2]) + S76[2][3]*(Jc7[1][5]*Si67[3][1] + Jc7[2][5]*Si67[3][2]);

Jc6[4][1]=links[6].inertia[1][1] + S76[1][1]*(Jc7[4][1]*Si67[1][1] + Jc7[5][1]*Si67[1][2]) + S76[2][1]*(Jc7[4][2]*Si67[1][1] + Jc7[5][2]*Si67[1][2]);
Jc6[4][2]=links[6].inertia[1][2] - Jc7[4][3]*Si67[1][1] - Jc7[5][3]*Si67[1][2] - DHA7*S76[1][3]*(Jc7[4][4]*Si67[1][1] + Jc7[5][4]*Si67[1][2]) - DHA7*S76[2][3]*(Jc7[4][5]*Si67[1][1] + Jc7[5][5]*Si67[1][2]);
Jc6[4][3]=links[6].inertia[1][3] + S76[1][3]*(Jc7[4][1]*Si67[1][1] + Jc7[5][1]*Si67[1][2]) + S76[2][3]*(Jc7[4][2]*Si67[1][1] + Jc7[5][2]*Si67[1][2]) - DHA7*(Jc7[4][6]*Si67[1][1] + Jc7[5][6]*Si67[1][2]);
Jc6[4][4]=S76[1][1]*(Jc7[4][4]*Si67[1][1] + Jc7[5][4]*Si67[1][2]) + S76[2][1]*(Jc7[4][5]*Si67[1][1] + Jc7[5][5]*Si67[1][2]);
Jc6[4][5]=-links[6].mcm[3] - Jc7[4][6]*Si67[1][1] - Jc7[5][6]*Si67[1][2];
Jc6[4][6]=links[6].mcm[2] + S76[1][3]*(Jc7[4][4]*Si67[1][1] + Jc7[5][4]*Si67[1][2]) + S76[2][3]*(Jc7[4][5]*Si67[1][1] + Jc7[5][5]*Si67[1][2]);

Jc6[5][1]=links[6].inertia[1][2] + S76[1][1]*(-Jc7[6][1] - DHA7*Jc7[1][1]*Si67[3][1] - DHA7*Jc7[2][1]*Si67[3][2]) + S76[2][1]*(-Jc7[6][2] - DHA7*Jc7[1][2]*Si67[3][1] - DHA7*Jc7[2][2]*Si67[3][2]);
Jc6[5][2]=Jc7[6][3] + links[6].inertia[2][2] + DHA7*Jc7[1][3]*Si67[3][1] + DHA7*Jc7[2][3]*Si67[3][2] - DHA7*S76[1][3]*(-Jc7[6][4] - DHA7*Jc7[1][4]*Si67[3][1] - DHA7*Jc7[2][4]*Si67[3][2]) - DHA7*S76[2][3]*(-Jc7[6][5] - DHA7*Jc7[1][5]*Si67[3][1] - DHA7*Jc7[2][5]*Si67[3][2]);
Jc6[5][3]=links[6].inertia[2][3] + S76[1][3]*(-Jc7[6][1] - DHA7*Jc7[1][1]*Si67[3][1] - DHA7*Jc7[2][1]*Si67[3][2]) + S76[2][3]*(-Jc7[6][2] - DHA7*Jc7[1][2]*Si67[3][1] - DHA7*Jc7[2][2]*Si67[3][2]) - DHA7*(-Jc7[6][6] - DHA7*Jc7[1][6]*Si67[3][1] - DHA7*Jc7[2][6]*Si67[3][2]);
Jc6[5][4]=links[6].mcm[3] + S76[1][1]*(-Jc7[6][4] - DHA7*Jc7[1][4]*Si67[3][1] - DHA7*Jc7[2][4]*Si67[3][2]) + S76[2][1]*(-Jc7[6][5] - DHA7*Jc7[1][5]*Si67[3][1] - DHA7*Jc7[2][5]*Si67[3][2]);
Jc6[5][5]=Jc7[6][6] + DHA7*Jc7[1][6]*Si67[3][1] + DHA7*Jc7[2][6]*Si67[3][2];
Jc6[5][6]=-links[6].mcm[1] + S76[1][3]*(-Jc7[6][4] - DHA7*Jc7[1][4]*Si67[3][1] - DHA7*Jc7[2][4]*Si67[3][2]) + S76[2][3]*(-Jc7[6][5] - DHA7*Jc7[1][5]*Si67[3][1] - DHA7*Jc7[2][5]*Si67[3][2]);

Jc6[6][1]=links[6].inertia[1][3] + S76[1][1]*(-(DHA7*Jc7[3][1]) + Jc7[4][1]*Si67[3][1] + Jc7[5][1]*Si67[3][2]) + S76[2][1]*(-(DHA7*Jc7[3][2]) + Jc7[4][2]*Si67[3][1] + Jc7[5][2]*Si67[3][2]);
Jc6[6][2]=DHA7*Jc7[3][3] + links[6].inertia[2][3] - Jc7[4][3]*Si67[3][1] - Jc7[5][3]*Si67[3][2] - DHA7*S76[1][3]*(-(DHA7*Jc7[3][4]) + Jc7[4][4]*Si67[3][1] + Jc7[5][4]*Si67[3][2]) - DHA7*S76[2][3]*(-(DHA7*Jc7[3][5]) + Jc7[4][5]*Si67[3][1] + Jc7[5][5]*Si67[3][2]);
Jc6[6][3]=links[6].inertia[3][3] + S76[1][3]*(-(DHA7*Jc7[3][1]) + Jc7[4][1]*Si67[3][1] + Jc7[5][1]*Si67[3][2]) + S76[2][3]*(-(DHA7*Jc7[3][2]) + Jc7[4][2]*Si67[3][1] + Jc7[5][2]*Si67[3][2]) - DHA7*(-(DHA7*Jc7[3][6]) + Jc7[4][6]*Si67[3][1] + Jc7[5][6]*Si67[3][2]);
Jc6[6][4]=-links[6].mcm[2] + S76[1][1]*(-(DHA7*Jc7[3][4]) + Jc7[4][4]*Si67[3][1] + Jc7[5][4]*Si67[3][2]) + S76[2][1]*(-(DHA7*Jc7[3][5]) + Jc7[4][5]*Si67[3][1] + Jc7[5][5]*Si67[3][2]);
Jc6[6][5]=links[6].mcm[1] + DHA7*Jc7[3][6] - Jc7[4][6]*Si67[3][1] - Jc7[5][6]*Si67[3][2];
Jc6[6][6]=S76[1][3]*(-(DHA7*Jc7[3][4]) + Jc7[4][4]*Si67[3][1] + Jc7[5][4]*Si67[3][2]) + S76[2][3]*(-(DHA7*Jc7[3][5]) + Jc7[4][5]*Si67[3][1] + Jc7[5][5]*Si67[3][2]);


Jc5[1][1]=S65[1][1]*(Jc6[1][1]*Si56[1][1] + Jc6[2][1]*Si56[1][2]) + S65[2][1]*(Jc6[1][2]*Si56[1][1] + Jc6[2][2]*Si56[1][2]);
Jc5[1][2]=links[5].mcm[3] - Jc6[1][3]*Si56[1][1] - Jc6[2][3]*Si56[1][2];
Jc5[1][3]=-links[5].mcm[2] + S65[1][3]*(Jc6[1][1]*Si56[1][1] + Jc6[2][1]*Si56[1][2]) + S65[2][3]*(Jc6[1][2]*Si56[1][1] + Jc6[2][2]*Si56[1][2]);
Jc5[1][4]=links[5].m + S65[1][1]*(Jc6[1][4]*Si56[1][1] + Jc6[2][4]*Si56[1][2]) + S65[2][1]*(Jc6[1][5]*Si56[1][1] + Jc6[2][5]*Si56[1][2]);
Jc5[1][5]=-(Jc6[1][6]*Si56[1][1]) - Jc6[2][6]*Si56[1][2];
Jc5[1][6]=S65[1][3]*(Jc6[1][4]*Si56[1][1] + Jc6[2][4]*Si56[1][2]) + S65[2][3]*(Jc6[1][5]*Si56[1][1] + Jc6[2][5]*Si56[1][2]);

Jc5[2][1]=-links[5].mcm[3] - Jc6[3][1]*S65[1][1] - Jc6[3][2]*S65[2][1];
Jc5[2][2]=Jc6[3][3];
Jc5[2][3]=links[5].mcm[1] - Jc6[3][1]*S65[1][3] - Jc6[3][2]*S65[2][3];
Jc5[2][4]=-(Jc6[3][4]*S65[1][1]) - Jc6[3][5]*S65[2][1];
Jc5[2][5]=links[5].m + Jc6[3][6];
Jc5[2][6]=-(Jc6[3][4]*S65[1][3]) - Jc6[3][5]*S65[2][3];

Jc5[3][1]=links[5].mcm[2] + S65[1][1]*(Jc6[1][1]*Si56[3][1] + Jc6[2][1]*Si56[3][2]) + S65[2][1]*(Jc6[1][2]*Si56[3][1] + Jc6[2][2]*Si56[3][2]);
Jc5[3][2]=-links[5].mcm[1] - Jc6[1][3]*Si56[3][1] - Jc6[2][3]*Si56[3][2];
Jc5[3][3]=S65[1][3]*(Jc6[1][1]*Si56[3][1] + Jc6[2][1]*Si56[3][2]) + S65[2][3]*(Jc6[1][2]*Si56[3][1] + Jc6[2][2]*Si56[3][2]);
Jc5[3][4]=S65[1][1]*(Jc6[1][4]*Si56[3][1] + Jc6[2][4]*Si56[3][2]) + S65[2][1]*(Jc6[1][5]*Si56[3][1] + Jc6[2][5]*Si56[3][2]);
Jc5[3][5]=-(Jc6[1][6]*Si56[3][1]) - Jc6[2][6]*Si56[3][2];
Jc5[3][6]=links[5].m + S65[1][3]*(Jc6[1][4]*Si56[3][1] + Jc6[2][4]*Si56[3][2]) + S65[2][3]*(Jc6[1][5]*Si56[3][1] + Jc6[2][5]*Si56[3][2]);

Jc5[4][1]=links[5].inertia[1][1] + S65[1][1]*(Jc6[4][1]*Si56[1][1] + Jc6[5][1]*Si56[1][2]) + S65[2][1]*(Jc6[4][2]*Si56[1][1] + Jc6[5][2]*Si56[1][2]);
Jc5[4][2]=links[5].inertia[1][2] - Jc6[4][3]*Si56[1][1] - Jc6[5][3]*Si56[1][2];
Jc5[4][3]=links[5].inertia[1][3] + S65[1][3]*(Jc6[4][1]*Si56[1][1] + Jc6[5][1]*Si56[1][2]) + S65[2][3]*(Jc6[4][2]*Si56[1][1] + Jc6[5][2]*Si56[1][2]);
Jc5[4][4]=S65[1][1]*(Jc6[4][4]*Si56[1][1] + Jc6[5][4]*Si56[1][2]) + S65[2][1]*(Jc6[4][5]*Si56[1][1] + Jc6[5][5]*Si56[1][2]);
Jc5[4][5]=-links[5].mcm[3] - Jc6[4][6]*Si56[1][1] - Jc6[5][6]*Si56[1][2];
Jc5[4][6]=links[5].mcm[2] + S65[1][3]*(Jc6[4][4]*Si56[1][1] + Jc6[5][4]*Si56[1][2]) + S65[2][3]*(Jc6[4][5]*Si56[1][1] + Jc6[5][5]*Si56[1][2]);

Jc5[5][1]=links[5].inertia[1][2] - Jc6[6][1]*S65[1][1] - Jc6[6][2]*S65[2][1];
Jc5[5][2]=Jc6[6][3] + links[5].inertia[2][2];
Jc5[5][3]=links[5].inertia[2][3] - Jc6[6][1]*S65[1][3] - Jc6[6][2]*S65[2][3];
Jc5[5][4]=links[5].mcm[3] - Jc6[6][4]*S65[1][1] - Jc6[6][5]*S65[2][1];
Jc5[5][5]=Jc6[6][6];
Jc5[5][6]=-links[5].mcm[1] - Jc6[6][4]*S65[1][3] - Jc6[6][5]*S65[2][3];

Jc5[6][1]=links[5].inertia[1][3] + S65[1][1]*(Jc6[4][1]*Si56[3][1] + Jc6[5][1]*Si56[3][2]) + S65[2][1]*(Jc6[4][2]*Si56[3][1] + Jc6[5][2]*Si56[3][2]);
Jc5[6][2]=links[5].inertia[2][3] - Jc6[4][3]*Si56[3][1] - Jc6[5][3]*Si56[3][2];
Jc5[6][3]=links[5].inertia[3][3] + S65[1][3]*(Jc6[4][1]*Si56[3][1] + Jc6[5][1]*Si56[3][2]) + S65[2][3]*(Jc6[4][2]*Si56[3][1] + Jc6[5][2]*Si56[3][2]);
Jc5[6][4]=-links[5].mcm[2] + S65[1][1]*(Jc6[4][4]*Si56[3][1] + Jc6[5][4]*Si56[3][2]) + S65[2][1]*(Jc6[4][5]*Si56[3][1] + Jc6[5][5]*Si56[3][2]);
Jc5[6][5]=links[5].mcm[1] - Jc6[4][6]*Si56[3][1] - Jc6[5][6]*Si56[3][2];
Jc5[6][6]=S65[1][3]*(Jc6[4][4]*Si56[3][1] + Jc6[5][4]*Si56[3][2]) + S65[2][3]*(Jc6[4][5]*Si56[3][1] + Jc6[5][5]*Si56[3][2]);


Jc4[1][1]=S54[1][1]*(Jc5[1][1]*Si45[1][1] + Jc5[2][1]*Si45[1][2]) + S54[2][1]*(Jc5[1][2]*Si45[1][1] + Jc5[2][2]*Si45[1][2]) + DHD5*S54[1][3]*(Jc5[1][4]*Si45[1][1] + Jc5[2][4]*Si45[1][2]) + DHD5*S54[2][3]*(Jc5[1][5]*Si45[1][1] + Jc5[2][5]*Si45[1][2]);
Jc4[1][2]=links[4].mcm[3] + Jc5[1][3]*Si45[1][1] + Jc5[2][3]*Si45[1][2] - DHA5*S54[1][3]*(Jc5[1][4]*Si45[1][1] + Jc5[2][4]*Si45[1][2]) - DHA5*S54[2][3]*(Jc5[1][5]*Si45[1][1] + Jc5[2][5]*Si45[1][2]);
Jc4[1][3]=-links[4].mcm[2] + S54[1][3]*(Jc5[1][1]*Si45[1][1] + Jc5[2][1]*Si45[1][2]) + S54[2][3]*(Jc5[1][2]*Si45[1][1] + Jc5[2][2]*Si45[1][2]) - DHD5*S54[1][1]*(Jc5[1][4]*Si45[1][1] + Jc5[2][4]*Si45[1][2]) - DHD5*S54[2][1]*(Jc5[1][5]*Si45[1][1] + Jc5[2][5]*Si45[1][2]) + DHA5*(Jc5[1][6]*Si45[1][1] + Jc5[2][6]*Si45[1][2]);
Jc4[1][4]=links[4].m + S54[1][1]*(Jc5[1][4]*Si45[1][1] + Jc5[2][4]*Si45[1][2]) + S54[2][1]*(Jc5[1][5]*Si45[1][1] + Jc5[2][5]*Si45[1][2]);
Jc4[1][5]=Jc5[1][6]*Si45[1][1] + Jc5[2][6]*Si45[1][2];
Jc4[1][6]=S54[1][3]*(Jc5[1][4]*Si45[1][1] + Jc5[2][4]*Si45[1][2]) + S54[2][3]*(Jc5[1][5]*Si45[1][1] + Jc5[2][5]*Si45[1][2]);

Jc4[2][1]=-links[4].mcm[3] + Jc5[3][1]*S54[1][1] + DHD5*Jc5[3][4]*S54[1][3] + Jc5[3][2]*S54[2][1] + DHD5*Jc5[3][5]*S54[2][3];
Jc4[2][2]=Jc5[3][3] - DHA5*Jc5[3][4]*S54[1][3] - DHA5*Jc5[3][5]*S54[2][3];
Jc4[2][3]=links[4].mcm[1] + DHA5*Jc5[3][6] - DHD5*Jc5[3][4]*S54[1][1] + Jc5[3][1]*S54[1][3] - DHD5*Jc5[3][5]*S54[2][1] + Jc5[3][2]*S54[2][3];
Jc4[2][4]=Jc5[3][4]*S54[1][1] + Jc5[3][5]*S54[2][1];
Jc4[2][5]=links[4].m + Jc5[3][6];
Jc4[2][6]=Jc5[3][4]*S54[1][3] + Jc5[3][5]*S54[2][3];

Jc4[3][1]=links[4].mcm[2] + S54[1][1]*(Jc5[1][1]*Si45[3][1] + Jc5[2][1]*Si45[3][2]) + S54[2][1]*(Jc5[1][2]*Si45[3][1] + Jc5[2][2]*Si45[3][2]) + DHD5*S54[1][3]*(Jc5[1][4]*Si45[3][1] + Jc5[2][4]*Si45[3][2]) + DHD5*S54[2][3]*(Jc5[1][5]*Si45[3][1] + Jc5[2][5]*Si45[3][2]);
Jc4[3][2]=-links[4].mcm[1] + Jc5[1][3]*Si45[3][1] + Jc5[2][3]*Si45[3][2] - DHA5*S54[1][3]*(Jc5[1][4]*Si45[3][1] + Jc5[2][4]*Si45[3][2]) - DHA5*S54[2][3]*(Jc5[1][5]*Si45[3][1] + Jc5[2][5]*Si45[3][2]);
Jc4[3][3]=S54[1][3]*(Jc5[1][1]*Si45[3][1] + Jc5[2][1]*Si45[3][2]) + S54[2][3]*(Jc5[1][2]*Si45[3][1] + Jc5[2][2]*Si45[3][2]) - DHD5*S54[1][1]*(Jc5[1][4]*Si45[3][1] + Jc5[2][4]*Si45[3][2]) - DHD5*S54[2][1]*(Jc5[1][5]*Si45[3][1] + Jc5[2][5]*Si45[3][2]) + DHA5*(Jc5[1][6]*Si45[3][1] + Jc5[2][6]*Si45[3][2]);
Jc4[3][4]=S54[1][1]*(Jc5[1][4]*Si45[3][1] + Jc5[2][4]*Si45[3][2]) + S54[2][1]*(Jc5[1][5]*Si45[3][1] + Jc5[2][5]*Si45[3][2]);
Jc4[3][5]=Jc5[1][6]*Si45[3][1] + Jc5[2][6]*Si45[3][2];
Jc4[3][6]=links[4].m + S54[1][3]*(Jc5[1][4]*Si45[3][1] + Jc5[2][4]*Si45[3][2]) + S54[2][3]*(Jc5[1][5]*Si45[3][1] + Jc5[2][5]*Si45[3][2]);

Jc4[4][1]=links[4].inertia[1][1] + S54[1][1]*(Jc5[4][1]*Si45[1][1] + Jc5[5][1]*Si45[1][2] + DHD5*Jc5[1][1]*Si45[3][1] + DHD5*Jc5[2][1]*Si45[3][2]) + S54[2][1]*(Jc5[4][2]*Si45[1][1] + Jc5[5][2]*Si45[1][2] + DHD5*Jc5[1][2]*Si45[3][1] + DHD5*Jc5[2][2]*Si45[3][2]) + DHD5*S54[1][3]*(Jc5[4][4]*Si45[1][1] + Jc5[5][4]*Si45[1][2] + DHD5*Jc5[1][4]*Si45[3][1] + DHD5*Jc5[2][4]*Si45[3][2]) + DHD5*S54[2][3]*(Jc5[4][5]*Si45[1][1] + Jc5[5][5]*Si45[1][2] + DHD5*Jc5[1][5]*Si45[3][1] + DHD5*Jc5[2][5]*Si45[3][2]);
Jc4[4][2]=links[4].inertia[1][2] + Jc5[4][3]*Si45[1][1] + Jc5[5][3]*Si45[1][2] + DHD5*Jc5[1][3]*Si45[3][1] + DHD5*Jc5[2][3]*Si45[3][2] - DHA5*S54[1][3]*(Jc5[4][4]*Si45[1][1] + Jc5[5][4]*Si45[1][2] + DHD5*Jc5[1][4]*Si45[3][1] + DHD5*Jc5[2][4]*Si45[3][2]) - DHA5*S54[2][3]*(Jc5[4][5]*Si45[1][1] + Jc5[5][5]*Si45[1][2] + DHD5*Jc5[1][5]*Si45[3][1] + DHD5*Jc5[2][5]*Si45[3][2]);
Jc4[4][3]=links[4].inertia[1][3] + S54[1][3]*(Jc5[4][1]*Si45[1][1] + Jc5[5][1]*Si45[1][2] + DHD5*Jc5[1][1]*Si45[3][1] + DHD5*Jc5[2][1]*Si45[3][2]) + S54[2][3]*(Jc5[4][2]*Si45[1][1] + Jc5[5][2]*Si45[1][2] + DHD5*Jc5[1][2]*Si45[3][1] + DHD5*Jc5[2][2]*Si45[3][2]) - DHD5*S54[1][1]*(Jc5[4][4]*Si45[1][1] + Jc5[5][4]*Si45[1][2] + DHD5*Jc5[1][4]*Si45[3][1] + DHD5*Jc5[2][4]*Si45[3][2]) - DHD5*S54[2][1]*(Jc5[4][5]*Si45[1][1] + Jc5[5][5]*Si45[1][2] + DHD5*Jc5[1][5]*Si45[3][1] + DHD5*Jc5[2][5]*Si45[3][2]) + DHA5*(Jc5[4][6]*Si45[1][1] + Jc5[5][6]*Si45[1][2] + DHD5*Jc5[1][6]*Si45[3][1] + DHD5*Jc5[2][6]*Si45[3][2]);
Jc4[4][4]=S54[1][1]*(Jc5[4][4]*Si45[1][1] + Jc5[5][4]*Si45[1][2] + DHD5*Jc5[1][4]*Si45[3][1] + DHD5*Jc5[2][4]*Si45[3][2]) + S54[2][1]*(Jc5[4][5]*Si45[1][1] + Jc5[5][5]*Si45[1][2] + DHD5*Jc5[1][5]*Si45[3][1] + DHD5*Jc5[2][5]*Si45[3][2]);
Jc4[4][5]=-links[4].mcm[3] + Jc5[4][6]*Si45[1][1] + Jc5[5][6]*Si45[1][2] + DHD5*Jc5[1][6]*Si45[3][1] + DHD5*Jc5[2][6]*Si45[3][2];
Jc4[4][6]=links[4].mcm[2] + S54[1][3]*(Jc5[4][4]*Si45[1][1] + Jc5[5][4]*Si45[1][2] + DHD5*Jc5[1][4]*Si45[3][1] + DHD5*Jc5[2][4]*Si45[3][2]) + S54[2][3]*(Jc5[4][5]*Si45[1][1] + Jc5[5][5]*Si45[1][2] + DHD5*Jc5[1][5]*Si45[3][1] + DHD5*Jc5[2][5]*Si45[3][2]);

Jc4[5][1]=links[4].inertia[1][2] + S54[1][1]*(Jc5[6][1] - DHA5*Jc5[1][1]*Si45[3][1] - DHA5*Jc5[2][1]*Si45[3][2]) + S54[2][1]*(Jc5[6][2] - DHA5*Jc5[1][2]*Si45[3][1] - DHA5*Jc5[2][2]*Si45[3][2]) + DHD5*S54[1][3]*(Jc5[6][4] - DHA5*Jc5[1][4]*Si45[3][1] - DHA5*Jc5[2][4]*Si45[3][2]) + DHD5*S54[2][3]*(Jc5[6][5] - DHA5*Jc5[1][5]*Si45[3][1] - DHA5*Jc5[2][5]*Si45[3][2]);
Jc4[5][2]=Jc5[6][3] + links[4].inertia[2][2] - DHA5*Jc5[1][3]*Si45[3][1] - DHA5*Jc5[2][3]*Si45[3][2] - DHA5*S54[1][3]*(Jc5[6][4] - DHA5*Jc5[1][4]*Si45[3][1] - DHA5*Jc5[2][4]*Si45[3][2]) - DHA5*S54[2][3]*(Jc5[6][5] - DHA5*Jc5[1][5]*Si45[3][1] - DHA5*Jc5[2][5]*Si45[3][2]);
Jc4[5][3]=links[4].inertia[2][3] + S54[1][3]*(Jc5[6][1] - DHA5*Jc5[1][1]*Si45[3][1] - DHA5*Jc5[2][1]*Si45[3][2]) + S54[2][3]*(Jc5[6][2] - DHA5*Jc5[1][2]*Si45[3][1] - DHA5*Jc5[2][2]*Si45[3][2]) - DHD5*S54[1][1]*(Jc5[6][4] - DHA5*Jc5[1][4]*Si45[3][1] - DHA5*Jc5[2][4]*Si45[3][2]) - DHD5*S54[2][1]*(Jc5[6][5] - DHA5*Jc5[1][5]*Si45[3][1] - DHA5*Jc5[2][5]*Si45[3][2]) + DHA5*(Jc5[6][6] - DHA5*Jc5[1][6]*Si45[3][1] - DHA5*Jc5[2][6]*Si45[3][2]);
Jc4[5][4]=links[4].mcm[3] + S54[1][1]*(Jc5[6][4] - DHA5*Jc5[1][4]*Si45[3][1] - DHA5*Jc5[2][4]*Si45[3][2]) + S54[2][1]*(Jc5[6][5] - DHA5*Jc5[1][5]*Si45[3][1] - DHA5*Jc5[2][5]*Si45[3][2]);
Jc4[5][5]=Jc5[6][6] - DHA5*Jc5[1][6]*Si45[3][1] - DHA5*Jc5[2][6]*Si45[3][2];
Jc4[5][6]=-links[4].mcm[1] + S54[1][3]*(Jc5[6][4] - DHA5*Jc5[1][4]*Si45[3][1] - DHA5*Jc5[2][4]*Si45[3][2]) + S54[2][3]*(Jc5[6][5] - DHA5*Jc5[1][5]*Si45[3][1] - DHA5*Jc5[2][5]*Si45[3][2]);

Jc4[6][1]=links[4].inertia[1][3] + S54[1][1]*(DHA5*Jc5[3][1] - DHD5*Jc5[1][1]*Si45[1][1] - DHD5*Jc5[2][1]*Si45[1][2] + Jc5[4][1]*Si45[3][1] + Jc5[5][1]*Si45[3][2]) + S54[2][1]*(DHA5*Jc5[3][2] - DHD5*Jc5[1][2]*Si45[1][1] - DHD5*Jc5[2][2]*Si45[1][2] + Jc5[4][2]*Si45[3][1] + Jc5[5][2]*Si45[3][2]) + DHD5*S54[1][3]*(DHA5*Jc5[3][4] - DHD5*Jc5[1][4]*Si45[1][1] - DHD5*Jc5[2][4]*Si45[1][2] + Jc5[4][4]*Si45[3][1] + Jc5[5][4]*Si45[3][2]) + DHD5*S54[2][3]*(DHA5*Jc5[3][5] - DHD5*Jc5[1][5]*Si45[1][1] - DHD5*Jc5[2][5]*Si45[1][2] + Jc5[4][5]*Si45[3][1] + Jc5[5][5]*Si45[3][2]);
Jc4[6][2]=DHA5*Jc5[3][3] + links[4].inertia[2][3] - DHD5*Jc5[1][3]*Si45[1][1] - DHD5*Jc5[2][3]*Si45[1][2] + Jc5[4][3]*Si45[3][1] + Jc5[5][3]*Si45[3][2] - DHA5*S54[1][3]*(DHA5*Jc5[3][4] - DHD5*Jc5[1][4]*Si45[1][1] - DHD5*Jc5[2][4]*Si45[1][2] + Jc5[4][4]*Si45[3][1] + Jc5[5][4]*Si45[3][2]) - DHA5*S54[2][3]*(DHA5*Jc5[3][5] - DHD5*Jc5[1][5]*Si45[1][1] - DHD5*Jc5[2][5]*Si45[1][2] + Jc5[4][5]*Si45[3][1] + Jc5[5][5]*Si45[3][2]);
Jc4[6][3]=links[4].inertia[3][3] + S54[1][3]*(DHA5*Jc5[3][1] - DHD5*Jc5[1][1]*Si45[1][1] - DHD5*Jc5[2][1]*Si45[1][2] + Jc5[4][1]*Si45[3][1] + Jc5[5][1]*Si45[3][2]) + S54[2][3]*(DHA5*Jc5[3][2] - DHD5*Jc5[1][2]*Si45[1][1] - DHD5*Jc5[2][2]*Si45[1][2] + Jc5[4][2]*Si45[3][1] + Jc5[5][2]*Si45[3][2]) - DHD5*S54[1][1]*(DHA5*Jc5[3][4] - DHD5*Jc5[1][4]*Si45[1][1] - DHD5*Jc5[2][4]*Si45[1][2] + Jc5[4][4]*Si45[3][1] + Jc5[5][4]*Si45[3][2]) - DHD5*S54[2][1]*(DHA5*Jc5[3][5] - DHD5*Jc5[1][5]*Si45[1][1] - DHD5*Jc5[2][5]*Si45[1][2] + Jc5[4][5]*Si45[3][1] + Jc5[5][5]*Si45[3][2]) + DHA5*(DHA5*Jc5[3][6] - DHD5*Jc5[1][6]*Si45[1][1] - DHD5*Jc5[2][6]*Si45[1][2] + Jc5[4][6]*Si45[3][1] + Jc5[5][6]*Si45[3][2]);
Jc4[6][4]=-links[4].mcm[2] + S54[1][1]*(DHA5*Jc5[3][4] - DHD5*Jc5[1][4]*Si45[1][1] - DHD5*Jc5[2][4]*Si45[1][2] + Jc5[4][4]*Si45[3][1] + Jc5[5][4]*Si45[3][2]) + S54[2][1]*(DHA5*Jc5[3][5] - DHD5*Jc5[1][5]*Si45[1][1] - DHD5*Jc5[2][5]*Si45[1][2] + Jc5[4][5]*Si45[3][1] + Jc5[5][5]*Si45[3][2]);
Jc4[6][5]=links[4].mcm[1] + DHA5*Jc5[3][6] - DHD5*Jc5[1][6]*Si45[1][1] - DHD5*Jc5[2][6]*Si45[1][2] + Jc5[4][6]*Si45[3][1] + Jc5[5][6]*Si45[3][2];
Jc4[6][6]=S54[1][3]*(DHA5*Jc5[3][4] - DHD5*Jc5[1][4]*Si45[1][1] - DHD5*Jc5[2][4]*Si45[1][2] + Jc5[4][4]*Si45[3][1] + Jc5[5][4]*Si45[3][2]) + S54[2][3]*(DHA5*Jc5[3][5] - DHD5*Jc5[1][5]*Si45[1][1] - DHD5*Jc5[2][5]*Si45[1][2] + Jc5[4][5]*Si45[3][1] + Jc5[5][5]*Si45[3][2]);


Jc3[1][1]=S43[1][1]*(Jc4[1][1]*Si34[1][1] + Jc4[2][1]*Si34[1][2]) + S43[2][1]*(Jc4[1][2]*Si34[1][1] + Jc4[2][2]*Si34[1][2]);
Jc3[1][2]=links[3].mcm[3] - Jc4[1][3]*Si34[1][1] - Jc4[2][3]*Si34[1][2] - DHA4*S43[1][3]*(Jc4[1][4]*Si34[1][1] + Jc4[2][4]*Si34[1][2]) - DHA4*S43[2][3]*(Jc4[1][5]*Si34[1][1] + Jc4[2][5]*Si34[1][2]);
Jc3[1][3]=-links[3].mcm[2] + S43[1][3]*(Jc4[1][1]*Si34[1][1] + Jc4[2][1]*Si34[1][2]) + S43[2][3]*(Jc4[1][2]*Si34[1][1] + Jc4[2][2]*Si34[1][2]) - DHA4*(Jc4[1][6]*Si34[1][1] + Jc4[2][6]*Si34[1][2]);
Jc3[1][4]=links[3].m + S43[1][1]*(Jc4[1][4]*Si34[1][1] + Jc4[2][4]*Si34[1][2]) + S43[2][1]*(Jc4[1][5]*Si34[1][1] + Jc4[2][5]*Si34[1][2]);
Jc3[1][5]=-(Jc4[1][6]*Si34[1][1]) - Jc4[2][6]*Si34[1][2];
Jc3[1][6]=S43[1][3]*(Jc4[1][4]*Si34[1][1] + Jc4[2][4]*Si34[1][2]) + S43[2][3]*(Jc4[1][5]*Si34[1][1] + Jc4[2][5]*Si34[1][2]);

Jc3[2][1]=-links[3].mcm[3] - Jc4[3][1]*S43[1][1] - Jc4[3][2]*S43[2][1];
Jc3[2][2]=Jc4[3][3] + DHA4*Jc4[3][4]*S43[1][3] + DHA4*Jc4[3][5]*S43[2][3];
Jc3[2][3]=links[3].mcm[1] + DHA4*Jc4[3][6] - Jc4[3][1]*S43[1][3] - Jc4[3][2]*S43[2][3];
Jc3[2][4]=-(Jc4[3][4]*S43[1][1]) - Jc4[3][5]*S43[2][1];
Jc3[2][5]=links[3].m + Jc4[3][6];
Jc3[2][6]=-(Jc4[3][4]*S43[1][3]) - Jc4[3][5]*S43[2][3];

Jc3[3][1]=links[3].mcm[2] + S43[1][1]*(Jc4[1][1]*Si34[3][1] + Jc4[2][1]*Si34[3][2]) + S43[2][1]*(Jc4[1][2]*Si34[3][1] + Jc4[2][2]*Si34[3][2]);
Jc3[3][2]=-links[3].mcm[1] - Jc4[1][3]*Si34[3][1] - Jc4[2][3]*Si34[3][2] - DHA4*S43[1][3]*(Jc4[1][4]*Si34[3][1] + Jc4[2][4]*Si34[3][2]) - DHA4*S43[2][3]*(Jc4[1][5]*Si34[3][1] + Jc4[2][5]*Si34[3][2]);
Jc3[3][3]=S43[1][3]*(Jc4[1][1]*Si34[3][1] + Jc4[2][1]*Si34[3][2]) + S43[2][3]*(Jc4[1][2]*Si34[3][1] + Jc4[2][2]*Si34[3][2]) - DHA4*(Jc4[1][6]*Si34[3][1] + Jc4[2][6]*Si34[3][2]);
Jc3[3][4]=S43[1][1]*(Jc4[1][4]*Si34[3][1] + Jc4[2][4]*Si34[3][2]) + S43[2][1]*(Jc4[1][5]*Si34[3][1] + Jc4[2][5]*Si34[3][2]);
Jc3[3][5]=-(Jc4[1][6]*Si34[3][1]) - Jc4[2][6]*Si34[3][2];
Jc3[3][6]=links[3].m + S43[1][3]*(Jc4[1][4]*Si34[3][1] + Jc4[2][4]*Si34[3][2]) + S43[2][3]*(Jc4[1][5]*Si34[3][1] + Jc4[2][5]*Si34[3][2]);

Jc3[4][1]=links[3].inertia[1][1] + S43[1][1]*(Jc4[4][1]*Si34[1][1] + Jc4[5][1]*Si34[1][2]) + S43[2][1]*(Jc4[4][2]*Si34[1][1] + Jc4[5][2]*Si34[1][2]);
Jc3[4][2]=links[3].inertia[1][2] - Jc4[4][3]*Si34[1][1] - Jc4[5][3]*Si34[1][2] - DHA4*S43[1][3]*(Jc4[4][4]*Si34[1][1] + Jc4[5][4]*Si34[1][2]) - DHA4*S43[2][3]*(Jc4[4][5]*Si34[1][1] + Jc4[5][5]*Si34[1][2]);
Jc3[4][3]=links[3].inertia[1][3] + S43[1][3]*(Jc4[4][1]*Si34[1][1] + Jc4[5][1]*Si34[1][2]) + S43[2][3]*(Jc4[4][2]*Si34[1][1] + Jc4[5][2]*Si34[1][2]) - DHA4*(Jc4[4][6]*Si34[1][1] + Jc4[5][6]*Si34[1][2]);
Jc3[4][4]=S43[1][1]*(Jc4[4][4]*Si34[1][1] + Jc4[5][4]*Si34[1][2]) + S43[2][1]*(Jc4[4][5]*Si34[1][1] + Jc4[5][5]*Si34[1][2]);
Jc3[4][5]=-links[3].mcm[3] - Jc4[4][6]*Si34[1][1] - Jc4[5][6]*Si34[1][2];
Jc3[4][6]=links[3].mcm[2] + S43[1][3]*(Jc4[4][4]*Si34[1][1] + Jc4[5][4]*Si34[1][2]) + S43[2][3]*(Jc4[4][5]*Si34[1][1] + Jc4[5][5]*Si34[1][2]);

Jc3[5][1]=links[3].inertia[1][2] + S43[1][1]*(-Jc4[6][1] - DHA4*Jc4[1][1]*Si34[3][1] - DHA4*Jc4[2][1]*Si34[3][2]) + S43[2][1]*(-Jc4[6][2] - DHA4*Jc4[1][2]*Si34[3][1] - DHA4*Jc4[2][2]*Si34[3][2]);
Jc3[5][2]=Jc4[6][3] + links[3].inertia[2][2] + DHA4*Jc4[1][3]*Si34[3][1] + DHA4*Jc4[2][3]*Si34[3][2] - DHA4*S43[1][3]*(-Jc4[6][4] - DHA4*Jc4[1][4]*Si34[3][1] - DHA4*Jc4[2][4]*Si34[3][2]) - DHA4*S43[2][3]*(-Jc4[6][5] - DHA4*Jc4[1][5]*Si34[3][1] - DHA4*Jc4[2][5]*Si34[3][2]);
Jc3[5][3]=links[3].inertia[2][3] + S43[1][3]*(-Jc4[6][1] - DHA4*Jc4[1][1]*Si34[3][1] - DHA4*Jc4[2][1]*Si34[3][2]) + S43[2][3]*(-Jc4[6][2] - DHA4*Jc4[1][2]*Si34[3][1] - DHA4*Jc4[2][2]*Si34[3][2]) - DHA4*(-Jc4[6][6] - DHA4*Jc4[1][6]*Si34[3][1] - DHA4*Jc4[2][6]*Si34[3][2]);
Jc3[5][4]=links[3].mcm[3] + S43[1][1]*(-Jc4[6][4] - DHA4*Jc4[1][4]*Si34[3][1] - DHA4*Jc4[2][4]*Si34[3][2]) + S43[2][1]*(-Jc4[6][5] - DHA4*Jc4[1][5]*Si34[3][1] - DHA4*Jc4[2][5]*Si34[3][2]);
Jc3[5][5]=Jc4[6][6] + DHA4*Jc4[1][6]*Si34[3][1] + DHA4*Jc4[2][6]*Si34[3][2];
Jc3[5][6]=-links[3].mcm[1] + S43[1][3]*(-Jc4[6][4] - DHA4*Jc4[1][4]*Si34[3][1] - DHA4*Jc4[2][4]*Si34[3][2]) + S43[2][3]*(-Jc4[6][5] - DHA4*Jc4[1][5]*Si34[3][1] - DHA4*Jc4[2][5]*Si34[3][2]);

Jc3[6][1]=links[3].inertia[1][3] + S43[1][1]*(-(DHA4*Jc4[3][1]) + Jc4[4][1]*Si34[3][1] + Jc4[5][1]*Si34[3][2]) + S43[2][1]*(-(DHA4*Jc4[3][2]) + Jc4[4][2]*Si34[3][1] + Jc4[5][2]*Si34[3][2]);
Jc3[6][2]=DHA4*Jc4[3][3] + links[3].inertia[2][3] - Jc4[4][3]*Si34[3][1] - Jc4[5][3]*Si34[3][2] - DHA4*S43[1][3]*(-(DHA4*Jc4[3][4]) + Jc4[4][4]*Si34[3][1] + Jc4[5][4]*Si34[3][2]) - DHA4*S43[2][3]*(-(DHA4*Jc4[3][5]) + Jc4[4][5]*Si34[3][1] + Jc4[5][5]*Si34[3][2]);
Jc3[6][3]=links[3].inertia[3][3] + S43[1][3]*(-(DHA4*Jc4[3][1]) + Jc4[4][1]*Si34[3][1] + Jc4[5][1]*Si34[3][2]) + S43[2][3]*(-(DHA4*Jc4[3][2]) + Jc4[4][2]*Si34[3][1] + Jc4[5][2]*Si34[3][2]) - DHA4*(-(DHA4*Jc4[3][6]) + Jc4[4][6]*Si34[3][1] + Jc4[5][6]*Si34[3][2]);
Jc3[6][4]=-links[3].mcm[2] + S43[1][1]*(-(DHA4*Jc4[3][4]) + Jc4[4][4]*Si34[3][1] + Jc4[5][4]*Si34[3][2]) + S43[2][1]*(-(DHA4*Jc4[3][5]) + Jc4[4][5]*Si34[3][1] + Jc4[5][5]*Si34[3][2]);
Jc3[6][5]=links[3].mcm[1] + DHA4*Jc4[3][6] - Jc4[4][6]*Si34[3][1] - Jc4[5][6]*Si34[3][2];
Jc3[6][6]=S43[1][3]*(-(DHA4*Jc4[3][4]) + Jc4[4][4]*Si34[3][1] + Jc4[5][4]*Si34[3][2]) + S43[2][3]*(-(DHA4*Jc4[3][5]) + Jc4[4][5]*Si34[3][1] + Jc4[5][5]*Si34[3][2]);


Jc2[1][1]=S32[1][1]*(Jc3[1][1]*Si23[1][1] + Jc3[2][1]*Si23[1][2]) + S32[2][1]*(Jc3[1][2]*Si23[1][1] + Jc3[2][2]*Si23[1][2]) - DHD3*S32[1][3]*(Jc3[1][4]*Si23[1][1] + Jc3[2][4]*Si23[1][2]) - DHD3*S32[2][3]*(Jc3[1][5]*Si23[1][1] + Jc3[2][5]*Si23[1][2]);
Jc2[1][2]=links[2].mcm[3] - Jc3[1][3]*Si23[1][1] - Jc3[2][3]*Si23[1][2];
Jc2[1][3]=-links[2].mcm[2] + S32[1][3]*(Jc3[1][1]*Si23[1][1] + Jc3[2][1]*Si23[1][2]) + S32[2][3]*(Jc3[1][2]*Si23[1][1] + Jc3[2][2]*Si23[1][2]) + DHD3*S32[1][1]*(Jc3[1][4]*Si23[1][1] + Jc3[2][4]*Si23[1][2]) + DHD3*S32[2][1]*(Jc3[1][5]*Si23[1][1] + Jc3[2][5]*Si23[1][2]);
Jc2[1][4]=links[2].m + S32[1][1]*(Jc3[1][4]*Si23[1][1] + Jc3[2][4]*Si23[1][2]) + S32[2][1]*(Jc3[1][5]*Si23[1][1] + Jc3[2][5]*Si23[1][2]);
Jc2[1][5]=-(Jc3[1][6]*Si23[1][1]) - Jc3[2][6]*Si23[1][2];
Jc2[1][6]=S32[1][3]*(Jc3[1][4]*Si23[1][1] + Jc3[2][4]*Si23[1][2]) + S32[2][3]*(Jc3[1][5]*Si23[1][1] + Jc3[2][5]*Si23[1][2]);

Jc2[2][1]=-links[2].mcm[3] - Jc3[3][1]*S32[1][1] + DHD3*Jc3[3][4]*S32[1][3] - Jc3[3][2]*S32[2][1] + DHD3*Jc3[3][5]*S32[2][3];
Jc2[2][2]=Jc3[3][3];
Jc2[2][3]=links[2].mcm[1] - DHD3*Jc3[3][4]*S32[1][1] - Jc3[3][1]*S32[1][3] - DHD3*Jc3[3][5]*S32[2][1] - Jc3[3][2]*S32[2][3];
Jc2[2][4]=-(Jc3[3][4]*S32[1][1]) - Jc3[3][5]*S32[2][1];
Jc2[2][5]=links[2].m + Jc3[3][6];
Jc2[2][6]=-(Jc3[3][4]*S32[1][3]) - Jc3[3][5]*S32[2][3];

Jc2[3][1]=links[2].mcm[2] + S32[1][1]*(Jc3[1][1]*Si23[3][1] + Jc3[2][1]*Si23[3][2]) + S32[2][1]*(Jc3[1][2]*Si23[3][1] + Jc3[2][2]*Si23[3][2]) - DHD3*S32[1][3]*(Jc3[1][4]*Si23[3][1] + Jc3[2][4]*Si23[3][2]) - DHD3*S32[2][3]*(Jc3[1][5]*Si23[3][1] + Jc3[2][5]*Si23[3][2]);
Jc2[3][2]=-links[2].mcm[1] - Jc3[1][3]*Si23[3][1] - Jc3[2][3]*Si23[3][2];
Jc2[3][3]=S32[1][3]*(Jc3[1][1]*Si23[3][1] + Jc3[2][1]*Si23[3][2]) + S32[2][3]*(Jc3[1][2]*Si23[3][1] + Jc3[2][2]*Si23[3][2]) + DHD3*S32[1][1]*(Jc3[1][4]*Si23[3][1] + Jc3[2][4]*Si23[3][2]) + DHD3*S32[2][1]*(Jc3[1][5]*Si23[3][1] + Jc3[2][5]*Si23[3][2]);
Jc2[3][4]=S32[1][1]*(Jc3[1][4]*Si23[3][1] + Jc3[2][4]*Si23[3][2]) + S32[2][1]*(Jc3[1][5]*Si23[3][1] + Jc3[2][5]*Si23[3][2]);
Jc2[3][5]=-(Jc3[1][6]*Si23[3][1]) - Jc3[2][6]*Si23[3][2];
Jc2[3][6]=links[2].m + S32[1][3]*(Jc3[1][4]*Si23[3][1] + Jc3[2][4]*Si23[3][2]) + S32[2][3]*(Jc3[1][5]*Si23[3][1] + Jc3[2][5]*Si23[3][2]);

Jc2[4][1]=links[2].inertia[1][1] + S32[1][1]*(Jc3[4][1]*Si23[1][1] + Jc3[5][1]*Si23[1][2] - DHD3*Jc3[1][1]*Si23[3][1] - DHD3*Jc3[2][1]*Si23[3][2]) + S32[2][1]*(Jc3[4][2]*Si23[1][1] + Jc3[5][2]*Si23[1][2] - DHD3*Jc3[1][2]*Si23[3][1] - DHD3*Jc3[2][2]*Si23[3][2]) - DHD3*S32[1][3]*(Jc3[4][4]*Si23[1][1] + Jc3[5][4]*Si23[1][2] - DHD3*Jc3[1][4]*Si23[3][1] - DHD3*Jc3[2][4]*Si23[3][2]) - DHD3*S32[2][3]*(Jc3[4][5]*Si23[1][1] + Jc3[5][5]*Si23[1][2] - DHD3*Jc3[1][5]*Si23[3][1] - DHD3*Jc3[2][5]*Si23[3][2]);
Jc2[4][2]=links[2].inertia[1][2] - Jc3[4][3]*Si23[1][1] - Jc3[5][3]*Si23[1][2] + DHD3*Jc3[1][3]*Si23[3][1] + DHD3*Jc3[2][3]*Si23[3][2];
Jc2[4][3]=links[2].inertia[1][3] + S32[1][3]*(Jc3[4][1]*Si23[1][1] + Jc3[5][1]*Si23[1][2] - DHD3*Jc3[1][1]*Si23[3][1] - DHD3*Jc3[2][1]*Si23[3][2]) + S32[2][3]*(Jc3[4][2]*Si23[1][1] + Jc3[5][2]*Si23[1][2] - DHD3*Jc3[1][2]*Si23[3][1] - DHD3*Jc3[2][2]*Si23[3][2]) + DHD3*S32[1][1]*(Jc3[4][4]*Si23[1][1] + Jc3[5][4]*Si23[1][2] - DHD3*Jc3[1][4]*Si23[3][1] - DHD3*Jc3[2][4]*Si23[3][2]) + DHD3*S32[2][1]*(Jc3[4][5]*Si23[1][1] + Jc3[5][5]*Si23[1][2] - DHD3*Jc3[1][5]*Si23[3][1] - DHD3*Jc3[2][5]*Si23[3][2]);
Jc2[4][4]=S32[1][1]*(Jc3[4][4]*Si23[1][1] + Jc3[5][4]*Si23[1][2] - DHD3*Jc3[1][4]*Si23[3][1] - DHD3*Jc3[2][4]*Si23[3][2]) + S32[2][1]*(Jc3[4][5]*Si23[1][1] + Jc3[5][5]*Si23[1][2] - DHD3*Jc3[1][5]*Si23[3][1] - DHD3*Jc3[2][5]*Si23[3][2]);
Jc2[4][5]=-links[2].mcm[3] - Jc3[4][6]*Si23[1][1] - Jc3[5][6]*Si23[1][2] + DHD3*Jc3[1][6]*Si23[3][1] + DHD3*Jc3[2][6]*Si23[3][2];
Jc2[4][6]=links[2].mcm[2] + S32[1][3]*(Jc3[4][4]*Si23[1][1] + Jc3[5][4]*Si23[1][2] - DHD3*Jc3[1][4]*Si23[3][1] - DHD3*Jc3[2][4]*Si23[3][2]) + S32[2][3]*(Jc3[4][5]*Si23[1][1] + Jc3[5][5]*Si23[1][2] - DHD3*Jc3[1][5]*Si23[3][1] - DHD3*Jc3[2][5]*Si23[3][2]);

Jc2[5][1]=links[2].inertia[1][2] - Jc3[6][1]*S32[1][1] + DHD3*Jc3[6][4]*S32[1][3] - Jc3[6][2]*S32[2][1] + DHD3*Jc3[6][5]*S32[2][3];
Jc2[5][2]=Jc3[6][3] + links[2].inertia[2][2];
Jc2[5][3]=links[2].inertia[2][3] - DHD3*Jc3[6][4]*S32[1][1] - Jc3[6][1]*S32[1][3] - DHD3*Jc3[6][5]*S32[2][1] - Jc3[6][2]*S32[2][3];
Jc2[5][4]=links[2].mcm[3] - Jc3[6][4]*S32[1][1] - Jc3[6][5]*S32[2][1];
Jc2[5][5]=Jc3[6][6];
Jc2[5][6]=-links[2].mcm[1] - Jc3[6][4]*S32[1][3] - Jc3[6][5]*S32[2][3];

Jc2[6][1]=links[2].inertia[1][3] + S32[1][1]*(DHD3*Jc3[1][1]*Si23[1][1] + DHD3*Jc3[2][1]*Si23[1][2] + Jc3[4][1]*Si23[3][1] + Jc3[5][1]*Si23[3][2]) + S32[2][1]*(DHD3*Jc3[1][2]*Si23[1][1] + DHD3*Jc3[2][2]*Si23[1][2] + Jc3[4][2]*Si23[3][1] + Jc3[5][2]*Si23[3][2]) - DHD3*S32[1][3]*(DHD3*Jc3[1][4]*Si23[1][1] + DHD3*Jc3[2][4]*Si23[1][2] + Jc3[4][4]*Si23[3][1] + Jc3[5][4]*Si23[3][2]) - DHD3*S32[2][3]*(DHD3*Jc3[1][5]*Si23[1][1] + DHD3*Jc3[2][5]*Si23[1][2] + Jc3[4][5]*Si23[3][1] + Jc3[5][5]*Si23[3][2]);
Jc2[6][2]=links[2].inertia[2][3] - DHD3*Jc3[1][3]*Si23[1][1] - DHD3*Jc3[2][3]*Si23[1][2] - Jc3[4][3]*Si23[3][1] - Jc3[5][3]*Si23[3][2];
Jc2[6][3]=links[2].inertia[3][3] + S32[1][3]*(DHD3*Jc3[1][1]*Si23[1][1] + DHD3*Jc3[2][1]*Si23[1][2] + Jc3[4][1]*Si23[3][1] + Jc3[5][1]*Si23[3][2]) + S32[2][3]*(DHD3*Jc3[1][2]*Si23[1][1] + DHD3*Jc3[2][2]*Si23[1][2] + Jc3[4][2]*Si23[3][1] + Jc3[5][2]*Si23[3][2]) + DHD3*S32[1][1]*(DHD3*Jc3[1][4]*Si23[1][1] + DHD3*Jc3[2][4]*Si23[1][2] + Jc3[4][4]*Si23[3][1] + Jc3[5][4]*Si23[3][2]) + DHD3*S32[2][1]*(DHD3*Jc3[1][5]*Si23[1][1] + DHD3*Jc3[2][5]*Si23[1][2] + Jc3[4][5]*Si23[3][1] + Jc3[5][5]*Si23[3][2]);
Jc2[6][4]=-links[2].mcm[2] + S32[1][1]*(DHD3*Jc3[1][4]*Si23[1][1] + DHD3*Jc3[2][4]*Si23[1][2] + Jc3[4][4]*Si23[3][1] + Jc3[5][4]*Si23[3][2]) + S32[2][1]*(DHD3*Jc3[1][5]*Si23[1][1] + DHD3*Jc3[2][5]*Si23[1][2] + Jc3[4][5]*Si23[3][1] + Jc3[5][5]*Si23[3][2]);
Jc2[6][5]=links[2].mcm[1] - DHD3*Jc3[1][6]*Si23[1][1] - DHD3*Jc3[2][6]*Si23[1][2] - Jc3[4][6]*Si23[3][1] - Jc3[5][6]*Si23[3][2];
Jc2[6][6]=S32[1][3]*(DHD3*Jc3[1][4]*Si23[1][1] + DHD3*Jc3[2][4]*Si23[1][2] + Jc3[4][4]*Si23[3][1] + Jc3[5][4]*Si23[3][2]) + S32[2][3]*(DHD3*Jc3[1][5]*Si23[1][1] + DHD3*Jc3[2][5]*Si23[1][2] + Jc3[4][5]*Si23[3][1] + Jc3[5][5]*Si23[3][2]);


Jc1[1][1]=S21[1][1]*(Jc2[1][1]*Si12[1][1] + Jc2[2][1]*Si12[1][2]) + S21[2][1]*(Jc2[1][2]*Si12[1][1] + Jc2[2][2]*Si12[1][2]);
Jc1[1][2]=links[1].mcm[3] + Jc2[1][3]*Si12[1][1] + Jc2[2][3]*Si12[1][2];
Jc1[1][3]=-links[1].mcm[2] + S21[1][3]*(Jc2[1][1]*Si12[1][1] + Jc2[2][1]*Si12[1][2]) + S21[2][3]*(Jc2[1][2]*Si12[1][1] + Jc2[2][2]*Si12[1][2]);
Jc1[1][4]=links[1].m + S21[1][1]*(Jc2[1][4]*Si12[1][1] + Jc2[2][4]*Si12[1][2]) + S21[2][1]*(Jc2[1][5]*Si12[1][1] + Jc2[2][5]*Si12[1][2]);
Jc1[1][5]=Jc2[1][6]*Si12[1][1] + Jc2[2][6]*Si12[1][2];
Jc1[1][6]=S21[1][3]*(Jc2[1][4]*Si12[1][1] + Jc2[2][4]*Si12[1][2]) + S21[2][3]*(Jc2[1][5]*Si12[1][1] + Jc2[2][5]*Si12[1][2]);

Jc1[2][1]=-links[1].mcm[3] + Jc2[3][1]*S21[1][1] + Jc2[3][2]*S21[2][1];
Jc1[2][2]=Jc2[3][3];
Jc1[2][3]=links[1].mcm[1] + Jc2[3][1]*S21[1][3] + Jc2[3][2]*S21[2][3];
Jc1[2][4]=Jc2[3][4]*S21[1][1] + Jc2[3][5]*S21[2][1];
Jc1[2][5]=links[1].m + Jc2[3][6];
Jc1[2][6]=Jc2[3][4]*S21[1][3] + Jc2[3][5]*S21[2][3];

Jc1[3][1]=links[1].mcm[2] + S21[1][1]*(Jc2[1][1]*Si12[3][1] + Jc2[2][1]*Si12[3][2]) + S21[2][1]*(Jc2[1][2]*Si12[3][1] + Jc2[2][2]*Si12[3][2]);
Jc1[3][2]=-links[1].mcm[1] + Jc2[1][3]*Si12[3][1] + Jc2[2][3]*Si12[3][2];
Jc1[3][3]=S21[1][3]*(Jc2[1][1]*Si12[3][1] + Jc2[2][1]*Si12[3][2]) + S21[2][3]*(Jc2[1][2]*Si12[3][1] + Jc2[2][2]*Si12[3][2]);
Jc1[3][4]=S21[1][1]*(Jc2[1][4]*Si12[3][1] + Jc2[2][4]*Si12[3][2]) + S21[2][1]*(Jc2[1][5]*Si12[3][1] + Jc2[2][5]*Si12[3][2]);
Jc1[3][5]=Jc2[1][6]*Si12[3][1] + Jc2[2][6]*Si12[3][2];
Jc1[3][6]=links[1].m + S21[1][3]*(Jc2[1][4]*Si12[3][1] + Jc2[2][4]*Si12[3][2]) + S21[2][3]*(Jc2[1][5]*Si12[3][1] + Jc2[2][5]*Si12[3][2]);

Jc1[4][1]=links[1].inertia[1][1] + S21[1][1]*(Jc2[4][1]*Si12[1][1] + Jc2[5][1]*Si12[1][2]) + S21[2][1]*(Jc2[4][2]*Si12[1][1] + Jc2[5][2]*Si12[1][2]);
Jc1[4][2]=links[1].inertia[1][2] + Jc2[4][3]*Si12[1][1] + Jc2[5][3]*Si12[1][2];
Jc1[4][3]=links[1].inertia[1][3] + S21[1][3]*(Jc2[4][1]*Si12[1][1] + Jc2[5][1]*Si12[1][2]) + S21[2][3]*(Jc2[4][2]*Si12[1][1] + Jc2[5][2]*Si12[1][2]);
Jc1[4][4]=S21[1][1]*(Jc2[4][4]*Si12[1][1] + Jc2[5][4]*Si12[1][2]) + S21[2][1]*(Jc2[4][5]*Si12[1][1] + Jc2[5][5]*Si12[1][2]);
Jc1[4][5]=-links[1].mcm[3] + Jc2[4][6]*Si12[1][1] + Jc2[5][6]*Si12[1][2];
Jc1[4][6]=links[1].mcm[2] + S21[1][3]*(Jc2[4][4]*Si12[1][1] + Jc2[5][4]*Si12[1][2]) + S21[2][3]*(Jc2[4][5]*Si12[1][1] + Jc2[5][5]*Si12[1][2]);

Jc1[5][1]=links[1].inertia[1][2] + Jc2[6][1]*S21[1][1] + Jc2[6][2]*S21[2][1];
Jc1[5][2]=Jc2[6][3] + links[1].inertia[2][2];
Jc1[5][3]=links[1].inertia[2][3] + Jc2[6][1]*S21[1][3] + Jc2[6][2]*S21[2][3];
Jc1[5][4]=links[1].mcm[3] + Jc2[6][4]*S21[1][1] + Jc2[6][5]*S21[2][1];
Jc1[5][5]=Jc2[6][6];
Jc1[5][6]=-links[1].mcm[1] + Jc2[6][4]*S21[1][3] + Jc2[6][5]*S21[2][3];

Jc1[6][1]=links[1].inertia[1][3] + S21[1][1]*(Jc2[4][1]*Si12[3][1] + Jc2[5][1]*Si12[3][2]) + S21[2][1]*(Jc2[4][2]*Si12[3][1] + Jc2[5][2]*Si12[3][2]);
Jc1[6][2]=links[1].inertia[2][3] + Jc2[4][3]*Si12[3][1] + Jc2[5][3]*Si12[3][2];
Jc1[6][3]=links[1].inertia[3][3] + S21[1][3]*(Jc2[4][1]*Si12[3][1] + Jc2[5][1]*Si12[3][2]) + S21[2][3]*(Jc2[4][2]*Si12[3][1] + Jc2[5][2]*Si12[3][2]);
Jc1[6][4]=-links[1].mcm[2] + S21[1][1]*(Jc2[4][4]*Si12[3][1] + Jc2[5][4]*Si12[3][2]) + S21[2][1]*(Jc2[4][5]*Si12[3][1] + Jc2[5][5]*Si12[3][2]);
Jc1[6][5]=links[1].mcm[1] + Jc2[4][6]*Si12[3][1] + Jc2[5][6]*Si12[3][2];
Jc1[6][6]=S21[1][3]*(Jc2[4][4]*Si12[3][1] + Jc2[5][4]*Si12[3][2]) + S21[2][3]*(Jc2[4][5]*Si12[3][1] + Jc2[5][5]*Si12[3][2]);




}


void
pandafunc14(void)
      {
/* unit force elements of inertia matrix */

Fu77[1]=Jc7[1][3];
Fu77[2]=Jc7[2][3];
Fu77[3]=Jc7[3][3];
Fu77[4]=Jc7[4][3];
Fu77[5]=Jc7[5][3];
Fu77[6]=Jc7[6][3];

Fu76[1]=Fu77[1]*Si67[1][1] + Fu77[2]*Si67[1][2];
Fu76[2]=-Fu77[3];
Fu76[3]=Fu77[1]*Si67[3][1] + Fu77[2]*Si67[3][2];
Fu76[4]=Fu77[4]*Si67[1][1] + Fu77[5]*Si67[1][2];
Fu76[5]=-Fu77[6] - DHA7*Fu77[1]*Si67[3][1] - DHA7*Fu77[2]*Si67[3][2];
Fu76[6]=-(DHA7*Fu77[3]) + Fu77[4]*Si67[3][1] + Fu77[5]*Si67[3][2];

Fu75[1]=Fu76[1]*Si56[1][1] + Fu76[2]*Si56[1][2];
Fu75[2]=-Fu76[3];
Fu75[3]=Fu76[1]*Si56[3][1] + Fu76[2]*Si56[3][2];
Fu75[4]=Fu76[4]*Si56[1][1] + Fu76[5]*Si56[1][2];
Fu75[5]=-Fu76[6];
Fu75[6]=Fu76[4]*Si56[3][1] + Fu76[5]*Si56[3][2];

Fu74[1]=Fu75[1]*Si45[1][1] + Fu75[2]*Si45[1][2];
Fu74[2]=Fu75[3];
Fu74[3]=Fu75[1]*Si45[3][1] + Fu75[2]*Si45[3][2];
Fu74[4]=Fu75[4]*Si45[1][1] + Fu75[5]*Si45[1][2] + DHD5*Fu75[1]*Si45[3][1] + DHD5*Fu75[2]*Si45[3][2];
Fu74[5]=Fu75[6] - DHA5*Fu75[1]*Si45[3][1] - DHA5*Fu75[2]*Si45[3][2];
Fu74[6]=DHA5*Fu75[3] - DHD5*Fu75[1]*Si45[1][1] - DHD5*Fu75[2]*Si45[1][2] + Fu75[4]*Si45[3][1] + Fu75[5]*Si45[3][2];

Fu73[1]=Fu74[1]*Si34[1][1] + Fu74[2]*Si34[1][2];
Fu73[2]=-Fu74[3];
Fu73[3]=Fu74[1]*Si34[3][1] + Fu74[2]*Si34[3][2];
Fu73[4]=Fu74[4]*Si34[1][1] + Fu74[5]*Si34[1][2];
Fu73[5]=-Fu74[6] - DHA4*Fu74[1]*Si34[3][1] - DHA4*Fu74[2]*Si34[3][2];
Fu73[6]=-(DHA4*Fu74[3]) + Fu74[4]*Si34[3][1] + Fu74[5]*Si34[3][2];

Fu72[1]=Fu73[1]*Si23[1][1] + Fu73[2]*Si23[1][2];
Fu72[2]=-Fu73[3];
Fu72[3]=Fu73[1]*Si23[3][1] + Fu73[2]*Si23[3][2];
Fu72[4]=Fu73[4]*Si23[1][1] + Fu73[5]*Si23[1][2] - DHD3*Fu73[1]*Si23[3][1] - DHD3*Fu73[2]*Si23[3][2];
Fu72[5]=-Fu73[6];
Fu72[6]=DHD3*Fu73[1]*Si23[1][1] + DHD3*Fu73[2]*Si23[1][2] + Fu73[4]*Si23[3][1] + Fu73[5]*Si23[3][2];

Fu71[1]=Fu72[1]*Si12[1][1] + Fu72[2]*Si12[1][2];
Fu71[2]=Fu72[3];
Fu71[3]=Fu72[1]*Si12[3][1] + Fu72[2]*Si12[3][2];
Fu71[4]=Fu72[4]*Si12[1][1] + Fu72[5]*Si12[1][2];
Fu71[5]=Fu72[6];
Fu71[6]=Fu72[4]*Si12[3][1] + Fu72[5]*Si12[3][2];


Fu66[1]=Jc6[1][3];
Fu66[2]=Jc6[2][3];
Fu66[3]=Jc6[3][3];
Fu66[4]=Jc6[4][3];
Fu66[5]=Jc6[5][3];
Fu66[6]=Jc6[6][3];

Fu65[1]=Fu66[1]*Si56[1][1] + Fu66[2]*Si56[1][2];
Fu65[2]=-Fu66[3];
Fu65[3]=Fu66[1]*Si56[3][1] + Fu66[2]*Si56[3][2];
Fu65[4]=Fu66[4]*Si56[1][1] + Fu66[5]*Si56[1][2];
Fu65[5]=-Fu66[6];
Fu65[6]=Fu66[4]*Si56[3][1] + Fu66[5]*Si56[3][2];

Fu64[1]=Fu65[1]*Si45[1][1] + Fu65[2]*Si45[1][2];
Fu64[2]=Fu65[3];
Fu64[3]=Fu65[1]*Si45[3][1] + Fu65[2]*Si45[3][2];
Fu64[4]=Fu65[4]*Si45[1][1] + Fu65[5]*Si45[1][2] + DHD5*Fu65[1]*Si45[3][1] + DHD5*Fu65[2]*Si45[3][2];
Fu64[5]=Fu65[6] - DHA5*Fu65[1]*Si45[3][1] - DHA5*Fu65[2]*Si45[3][2];
Fu64[6]=DHA5*Fu65[3] - DHD5*Fu65[1]*Si45[1][1] - DHD5*Fu65[2]*Si45[1][2] + Fu65[4]*Si45[3][1] + Fu65[5]*Si45[3][2];

Fu63[1]=Fu64[1]*Si34[1][1] + Fu64[2]*Si34[1][2];
Fu63[2]=-Fu64[3];
Fu63[3]=Fu64[1]*Si34[3][1] + Fu64[2]*Si34[3][2];
Fu63[4]=Fu64[4]*Si34[1][1] + Fu64[5]*Si34[1][2];
Fu63[5]=-Fu64[6] - DHA4*Fu64[1]*Si34[3][1] - DHA4*Fu64[2]*Si34[3][2];
Fu63[6]=-(DHA4*Fu64[3]) + Fu64[4]*Si34[3][1] + Fu64[5]*Si34[3][2];

Fu62[1]=Fu63[1]*Si23[1][1] + Fu63[2]*Si23[1][2];
Fu62[2]=-Fu63[3];
Fu62[3]=Fu63[1]*Si23[3][1] + Fu63[2]*Si23[3][2];
Fu62[4]=Fu63[4]*Si23[1][1] + Fu63[5]*Si23[1][2] - DHD3*Fu63[1]*Si23[3][1] - DHD3*Fu63[2]*Si23[3][2];
Fu62[5]=-Fu63[6];
Fu62[6]=DHD3*Fu63[1]*Si23[1][1] + DHD3*Fu63[2]*Si23[1][2] + Fu63[4]*Si23[3][1] + Fu63[5]*Si23[3][2];

Fu61[1]=Fu62[1]*Si12[1][1] + Fu62[2]*Si12[1][2];
Fu61[2]=Fu62[3];
Fu61[3]=Fu62[1]*Si12[3][1] + Fu62[2]*Si12[3][2];
Fu61[4]=Fu62[4]*Si12[1][1] + Fu62[5]*Si12[1][2];
Fu61[5]=Fu62[6];
Fu61[6]=Fu62[4]*Si12[3][1] + Fu62[5]*Si12[3][2];


Fu55[1]=Jc5[1][3];
Fu55[2]=Jc5[2][3];
Fu55[3]=Jc5[3][3];
Fu55[4]=Jc5[4][3];
Fu55[5]=Jc5[5][3];
Fu55[6]=Jc5[6][3];

Fu54[1]=Fu55[1]*Si45[1][1] + Fu55[2]*Si45[1][2];
Fu54[2]=Fu55[3];
Fu54[3]=Fu55[1]*Si45[3][1] + Fu55[2]*Si45[3][2];
Fu54[4]=Fu55[4]*Si45[1][1] + Fu55[5]*Si45[1][2] + DHD5*Fu55[1]*Si45[3][1] + DHD5*Fu55[2]*Si45[3][2];
Fu54[5]=Fu55[6] - DHA5*Fu55[1]*Si45[3][1] - DHA5*Fu55[2]*Si45[3][2];
Fu54[6]=DHA5*Fu55[3] - DHD5*Fu55[1]*Si45[1][1] - DHD5*Fu55[2]*Si45[1][2] + Fu55[4]*Si45[3][1] + Fu55[5]*Si45[3][2];

Fu53[1]=Fu54[1]*Si34[1][1] + Fu54[2]*Si34[1][2];
Fu53[2]=-Fu54[3];
Fu53[3]=Fu54[1]*Si34[3][1] + Fu54[2]*Si34[3][2];
Fu53[4]=Fu54[4]*Si34[1][1] + Fu54[5]*Si34[1][2];
Fu53[5]=-Fu54[6] - DHA4*Fu54[1]*Si34[3][1] - DHA4*Fu54[2]*Si34[3][2];
Fu53[6]=-(DHA4*Fu54[3]) + Fu54[4]*Si34[3][1] + Fu54[5]*Si34[3][2];

Fu52[1]=Fu53[1]*Si23[1][1] + Fu53[2]*Si23[1][2];
Fu52[2]=-Fu53[3];
Fu52[3]=Fu53[1]*Si23[3][1] + Fu53[2]*Si23[3][2];
Fu52[4]=Fu53[4]*Si23[1][1] + Fu53[5]*Si23[1][2] - DHD3*Fu53[1]*Si23[3][1] - DHD3*Fu53[2]*Si23[3][2];
Fu52[5]=-Fu53[6];
Fu52[6]=DHD3*Fu53[1]*Si23[1][1] + DHD3*Fu53[2]*Si23[1][2] + Fu53[4]*Si23[3][1] + Fu53[5]*Si23[3][2];

Fu51[1]=Fu52[1]*Si12[1][1] + Fu52[2]*Si12[1][2];
Fu51[2]=Fu52[3];
Fu51[3]=Fu52[1]*Si12[3][1] + Fu52[2]*Si12[3][2];
Fu51[4]=Fu52[4]*Si12[1][1] + Fu52[5]*Si12[1][2];
Fu51[5]=Fu52[6];
Fu51[6]=Fu52[4]*Si12[3][1] + Fu52[5]*Si12[3][2];


Fu44[1]=Jc4[1][3];
Fu44[2]=Jc4[2][3];
Fu44[3]=Jc4[3][3];
Fu44[4]=Jc4[4][3];
Fu44[5]=Jc4[5][3];
Fu44[6]=Jc4[6][3];

Fu43[1]=Fu44[1]*Si34[1][1] + Fu44[2]*Si34[1][2];
Fu43[2]=-Fu44[3];
Fu43[3]=Fu44[1]*Si34[3][1] + Fu44[2]*Si34[3][2];
Fu43[4]=Fu44[4]*Si34[1][1] + Fu44[5]*Si34[1][2];
Fu43[5]=-Fu44[6] - DHA4*Fu44[1]*Si34[3][1] - DHA4*Fu44[2]*Si34[3][2];
Fu43[6]=-(DHA4*Fu44[3]) + Fu44[4]*Si34[3][1] + Fu44[5]*Si34[3][2];

Fu42[1]=Fu43[1]*Si23[1][1] + Fu43[2]*Si23[1][2];
Fu42[2]=-Fu43[3];
Fu42[3]=Fu43[1]*Si23[3][1] + Fu43[2]*Si23[3][2];
Fu42[4]=Fu43[4]*Si23[1][1] + Fu43[5]*Si23[1][2] - DHD3*Fu43[1]*Si23[3][1] - DHD3*Fu43[2]*Si23[3][2];
Fu42[5]=-Fu43[6];
Fu42[6]=DHD3*Fu43[1]*Si23[1][1] + DHD3*Fu43[2]*Si23[1][2] + Fu43[4]*Si23[3][1] + Fu43[5]*Si23[3][2];

Fu41[1]=Fu42[1]*Si12[1][1] + Fu42[2]*Si12[1][2];
Fu41[2]=Fu42[3];
Fu41[3]=Fu42[1]*Si12[3][1] + Fu42[2]*Si12[3][2];
Fu41[4]=Fu42[4]*Si12[1][1] + Fu42[5]*Si12[1][2];
Fu41[5]=Fu42[6];
Fu41[6]=Fu42[4]*Si12[3][1] + Fu42[5]*Si12[3][2];


Fu33[1]=Jc3[1][3];
Fu33[2]=Jc3[2][3];
Fu33[3]=Jc3[3][3];
Fu33[4]=Jc3[4][3];
Fu33[5]=Jc3[5][3];
Fu33[6]=Jc3[6][3];

Fu32[1]=Fu33[1]*Si23[1][1] + Fu33[2]*Si23[1][2];
Fu32[2]=-Fu33[3];
Fu32[3]=Fu33[1]*Si23[3][1] + Fu33[2]*Si23[3][2];
Fu32[4]=Fu33[4]*Si23[1][1] + Fu33[5]*Si23[1][2] - DHD3*Fu33[1]*Si23[3][1] - DHD3*Fu33[2]*Si23[3][2];
Fu32[5]=-Fu33[6];
Fu32[6]=DHD3*Fu33[1]*Si23[1][1] + DHD3*Fu33[2]*Si23[1][2] + Fu33[4]*Si23[3][1] + Fu33[5]*Si23[3][2];

Fu31[1]=Fu32[1]*Si12[1][1] + Fu32[2]*Si12[1][2];
Fu31[2]=Fu32[3];
Fu31[3]=Fu32[1]*Si12[3][1] + Fu32[2]*Si12[3][2];
Fu31[4]=Fu32[4]*Si12[1][1] + Fu32[5]*Si12[1][2];
Fu31[5]=Fu32[6];
Fu31[6]=Fu32[4]*Si12[3][1] + Fu32[5]*Si12[3][2];


Fu22[1]=Jc2[1][3];
Fu22[2]=Jc2[2][3];
Fu22[3]=Jc2[3][3];
Fu22[4]=Jc2[4][3];
Fu22[5]=Jc2[5][3];
Fu22[6]=Jc2[6][3];

Fu21[1]=Fu22[1]*Si12[1][1] + Fu22[2]*Si12[1][2];
Fu21[2]=Fu22[3];
Fu21[3]=Fu22[1]*Si12[3][1] + Fu22[2]*Si12[3][2];
Fu21[4]=Fu22[4]*Si12[1][1] + Fu22[5]*Si12[1][2];
Fu21[5]=Fu22[6];
Fu21[6]=Fu22[4]*Si12[3][1] + Fu22[5]*Si12[3][2];


Fu11[1]=Jc1[1][3];
Fu11[2]=Jc1[2][3];
Fu11[3]=Jc1[3][3];
Fu11[4]=Jc1[4][3];
Fu11[5]=Jc1[5][3];
Fu11[6]=Jc1[6][3];



}


void
pandafunc15(void)
      {
/* elements of inertia matrix */
H[1][1]=Fu11[6];
H[1][2]=0;
H[1][3]=0;
H[1][4]=0;
H[1][5]=0;
H[1][6]=0;
H[1][7]=0;
H[1][8]=0;

H[2][1]=Fu21[6];
H[2][2]=Fu22[6];
H[2][3]=0;
H[2][4]=0;
H[2][5]=0;
H[2][6]=0;
H[2][7]=0;
H[2][8]=0;

H[3][1]=Fu31[6];
H[3][2]=Fu32[6];
H[3][3]=Fu33[6];
H[3][4]=0;
H[3][5]=0;
H[3][6]=0;
H[3][7]=0;
H[3][8]=0;

H[4][1]=Fu41[6];
H[4][2]=Fu42[6];
H[4][3]=Fu43[6];
H[4][4]=Fu44[6];
H[4][5]=0;
H[4][6]=0;
H[4][7]=0;
H[4][8]=0;

H[5][1]=Fu51[6];
H[5][2]=Fu52[6];
H[5][3]=Fu53[6];
H[5][4]=Fu54[6];
H[5][5]=Fu55[6];
H[5][6]=0;
H[5][7]=0;
H[5][8]=0;

H[6][1]=Fu61[6];
H[6][2]=Fu62[6];
H[6][3]=Fu63[6];
H[6][4]=Fu64[6];
H[6][5]=Fu65[6];
H[6][6]=Fu66[6];
H[6][7]=0;
H[6][8]=0;

H[7][1]=Fu71[6];
H[7][2]=Fu72[6];
H[7][3]=Fu73[6];
H[7][4]=Fu74[6];
H[7][5]=Fu75[6];
H[7][6]=Fu76[6];
H[7][7]=Fu77[6];
H[7][8]=0;

H[8][1]=0;
H[8][2]=0;
H[8][3]=0;
H[8][4]=0;
H[8][5]=0;
H[8][6]=0;
H[8][7]=0;
H[8][8]=1;



}

